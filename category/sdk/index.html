<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; フィード" href="//feed/">
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; Yahoo フィード" href="//feed/yahoo/">
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; SmartNews フィード" href="//feed/smartnews/">
<link rel="manifest" href="/wp-content/themes/jh-hew/manifest.json">
<link rel="icon alternate" href="/wp-content/themes/jh-hew/img/favicon-48.png" type="image/png">
<link rel="apple-touch-icon" href="/wp-content/themes/jh-hew/img/apple-touch-icon180.png" sizes="180x180">
<meta name="theme-color" content="#FAD641">
<meta name="apple-mobile-web-app-title" content="JunkHack">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<script type="text/javascript">window.DocsBotAI=window.DocsBotAI||{},DocsBotAI.init=function(c){return new Promise(function(e,o){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://widget.docsbot.ai/chat.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),t.addEventListener("load",function(){window.DocsBotAI.mount({id:c.id,supportCallback:c.supportCallback,identify:c.identify,options:c.options});var t;t=function(n){return new Promise(function(e){if(document.querySelector(n))return e(document.querySelector(n));var o=new MutationObserver(function(t){document.querySelector(n)&&(e(document.querySelector(n)),o.disconnect())});o.observe(document.body,{childList:!0,subtree:!0})})},t&&t("#docsbotai-root").then(e).catch(o)}),t.addEventListener("error",function(t){o(t.message)})})};</script>
<script type="text/javascript">DocsBotAI.init({id: "HPyLlfLvXH85ROf3H0hM/r4tbR7inmYatdLFK2ZC0"});</script>

<script>if ('serviceWorker' in navigator && 'localhost' !== window.location.hostname) {
	window.addEventListener('load', function () {
		navigator.serviceWorker.register('/sw.js').then(
			function (registration) {
				console.log('ServiceWorker registration successful with scope: ', registration.scope);
			},
			function (err) {
				console.log('ServiceWorker registration failed: ', err);
			}
		);
	});
}</script>


		<link charset="utf-8" rel="stylesheet" type="text/css" href="/wp-content/themes/jh-hew/js/nehan2/nehan2.css">
		<script charset="utf-8" type="text/javascript" src="/wp-content/themes/jh-hew/js/nehan2/subject.js"></script>
		<script charset="utf-8" type="text/javascript" src="/wp-content/themes/jh-hew/js/nehan2/Plugin_haiku.js"></script>
		<script charset="utf-8" type="text/javascript" src="/wp-content/themes/jh-hew/js/nehan2/nehan2.js"></script>
		<script type="text/javascript">

		let pw = window.innerWidth;
		let ph = window.innerHeight;
		let wsize = 0;
		function resizeWindow(event){
				pw = window.innerWidth;
				ph = window.innerHeight;
		}
	
		window.addEventListener("resize", resizeWindow);

			window.onload = function(){
			var createPageFrame = function(body){
				var node = document.createElement("div");
				var style = node.style;
				node.innerHTML = body;
				node.className = "page-frame";
				return node;
			};

			var outputAllPages = function(dstId, provider){
				var pageNo = 0;
				var dstNode = document.getElementById(dstId);

				// add <subject> element to parser for easy markup(see subject.js)
				Nehan.Plugin.defineSubjectElement(provider);
				Nehan.Plugin_haiku.defineHaikuElement(provider);

				while(provider.hasNextPage()){
					var pageData = provider.outputPage(pageNo++);
					var pageFrame = createPageFrame(pageData.html);
					dstNode.appendChild(pageFrame);
				}
			};
			
			var text = document.getElementById("src-text").innerHTML;
		// output default page1.
		if(pw < 480){
			// output vertical post.27moji
			outputAllPages("result-vertical", new Nehan.PageProvider({
				direction:"vertical",
				width:310,
				height:440,
				fontSize:16
			}, text));
		}
		if(pw > 479 && pw < 600){
			// output vertical post.27moji
			outputAllPages("result-vertical", new Nehan.PageProvider({
				direction:"vertical",
				width:420,
				height:440,
				fontSize:16
			}, text));
		}
		if(pw > 599 && pw < 744){
			// output vertical post.27moji
			outputAllPages("result-vertical", new Nehan.PageProvider({
				direction:"vertical",
				width:540,
				height:440,
				fontSize:16
			}, text));
		}
		if(pw > 743 && pw < 889){
			// output vertical post.27moji
			outputAllPages("result-vertical", new Nehan.PageProvider({
				direction:"vertical",
				width:680,
				height:440,
				fontSize:16
			}, text));
		}
		if(pw > 888){
			// output vertical post.27moji
			outputAllPages("result-vertical", new Nehan.PageProvider({
				direction:"vertical",
				width:890,
				height:440,
				fontSize:16
			}, text));
		}
		
		document.getElementById("progress").style.display = "none";
		};
		</script>
		
<title>sdk &#8211; JunkHack</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; sdk カテゴリーのフィード" href="/category/sdk/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.4.3" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="wpel-style-css" href="/wp-content/plugins/wp-external-links/public/css/wpel.css?ver=2.60" type="text/css" media="all">
<style id="md-style-inline-css" type="text/css">.gfm-task-list { border: 1px solid transparent; list-style-type: none; } .gfm-task-list input { margin-right: 10px !important; } .katex-container { margin: 25px !important; text-align: center; } .katex-container.katex-inline { display: inline-block !important; background: none !important; margin: 0 !important; padding: 0 !important; } pre .katex-container { font-size: 1.4em !important; } .katex-inline { background: none !important; margin: 0 3px; } .copy-button { cursor: pointer; border: 0; font-size: 12px; text-transform: uppercase; font-weight: 500; padding: 3px 6px 3px 6px; background-color: rgba(255, 255, 255, 0.6); position: absolute; overflow: hidden; top: 5px; right: 5px; border-radius: 3px; } .copy-button:before { content: ""; display: inline-block; width: 16px; height: 16px; margin-right: 3px; background-size: contain; background-image: url("data:image/svg+xml,%3Csvg version=\'1.1\' xmlns=\'http://www.w3.org/2000/svg\' xmlns:xlink=\'http://www.w3.org/1999/xlink\' x=\'0px\' y=\'0px\' width=\'16px\' height=\'16px\' viewBox=\'888 888 16 16\' enable-background=\'new 888 888 16 16\' xml:space=\'preserve\'%3E %3Cpath fill=\'%23333333\' d=\'M903.143,891.429c0.238,0,0.44,0.083,0.607,0.25c0.167,0.167,0.25,0.369,0.25,0.607v10.857 c0,0.238-0.083,0.44-0.25,0.607s-0.369,0.25-0.607,0.25h-8.571c-0.238,0-0.44-0.083-0.607-0.25s-0.25-0.369-0.25-0.607v-2.571 h-4.857c-0.238,0-0.44-0.083-0.607-0.25s-0.25-0.369-0.25-0.607v-6c0-0.238,0.06-0.5,0.179-0.786s0.262-0.512,0.428-0.679 l3.643-3.643c0.167-0.167,0.393-0.309,0.679-0.428s0.547-0.179,0.786-0.179h3.714c0.238,0,0.44,0.083,0.607,0.25 c0.166,0.167,0.25,0.369,0.25,0.607v2.929c0.404-0.238,0.785-0.357,1.143-0.357H903.143z M898.286,893.331l-2.67,2.669h2.67V893.331 z M892.571,889.902l-2.669,2.669h2.669V889.902z M894.321,895.679l2.821-2.822v-3.714h-3.428v3.714c0,0.238-0.083,0.441-0.25,0.607 s-0.369,0.25-0.607,0.25h-3.714v5.714h4.571v-2.286c0-0.238,0.06-0.5,0.179-0.786C894.012,896.071,894.155,895.845,894.321,895.679z M902.857,902.857v-10.286h-3.429v3.714c0,0.238-0.083,0.441-0.25,0.607c-0.167,0.167-0.369,0.25-0.607,0.25h-3.714v5.715H902.857z\' /%3E %3C/svg%3E"); background-repeat: no-repeat; position: relative; top: 3px; } pre { position: relative; } pre:hover .copy-button { background-color: rgba(255, 255, 255, 0.9); } .post pre code script, .language-mathjax ~ .copy-button { display: none !important; }</style>
<link rel="stylesheet" id="mouse-css" href="/wp-content/plugins/wp-keypopup-algolia/mouse.css?ver=6.4.3" type="text/css" media="all">
<link rel="stylesheet" id="related-frontend-css-css" href="/wp-content/plugins/ccrw_related/css/frontend-style.css?ver=0.1.0" type="text/css" media="all">
<link rel="stylesheet" id="uagb-block-css-css" href="/wp-content/uploads/uag-plugin/custom-style-blocks.css?ver=2.12.3" type="text/css" media="all">
<link rel="stylesheet" id="JankHack-Hew-fonts-css" href="https://fonts.googleapis.com/css?family=Open+Sans%3A400%2C600%2C700%2C400italic%2C600italic%2C700italic%7CNoto+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="/wp-content/themes/jh-hew/genericons/genericons.css?ver=3.4.1" type="text/css" media="all">
<link rel="stylesheet" id="JankHack-Hew-style-css" href="/wp-content/themes/jh-hew/style.css?ver=6.4.3" type="text/css" media="all">
<link rel="stylesheet" id="algolia-autocomplete-css" href="/wp-content/plugins/wp-search-with-algolia/css/algolia-autocomplete.css?ver=2.7.1" type="text/css" media="all">
<link rel="stylesheet" id="emojify-css" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css?ver=1.1.0" type="text/css" media="all">
<script type="text/javascript" src="/wp-content/plugins/jquery-manager/assets/js/jquery-3.5.1.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-content/plugins/jquery-manager/assets/js/jquery-migrate-3.3.0.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" src="/wp-content/plugins/wp-keypopup-algolia/mousetrap.min.js?ver=6.4.3" id="mice-js"></script>
<script type="text/javascript" id="mouse-js-extra">
/* <![CDATA[ */
var mouse = {"home":"\/","list":"\/list\/","search":"\/s\/"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/wp-keypopup-algolia/mouse.js?ver=6.4.3" id="mouse-js"></script>
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/categories/71">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.4.3">
		<style>.algolia-search-highlight {
				background-color: #fffbcc;
				border-radius: 2px;
				font-style: normal;
			}</style>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style>
<style id="uagb-style-frontend-71">.uagb-block-188fea4d .uagb-search-form__container .uagb-search-submit{width: 60px;padding: 0;border: 0;}.uagb-block-188fea4d .uagb-search-form__container .uagb-search-form__input::placeholder{opacity: 0.6;}.uagb-block-188fea4d .uagb-search-form__container .uagb-search-submit .uagb-wp-search-button-icon-wrap svg{width: 17px;height: 17px;font-size: 17px;}.uagb-block-188fea4d .uagb-search-form__container .uagb-search-submit .uagb-wp-search-button-text{color: #313131;}.uagb-block-188fea4d.uagb-layout-input .uagb-wp-search-icon-wrap svg{width: 17px;height: 17px;font-size: 17px;}.uagb-block-188fea4d .uagb-search-form__container .uagb-search-form__input{background-color: #ECEEEF;border: 0;border-radius: 0px;margin: 0;outline: unset;padding-top: 15px;padding-bottom: 15px;padding-right: 13px;padding-left: 13px;}.uagb-block-188fea4d .uagb-search-wrapper .uagb-search-form__container{border-top-left-radius: 3px;border-top-right-radius: 3px;border-bottom-left-radius: 3px;border-bottom-right-radius: 3px;border-style: none;outline: unset;box-shadow: 0px 0px    ;transition: all .5s;width: 100%;}.uagb-block-188fea4d .uagb-search-form__container .uagb-wp-search-icon-wrap{background-color: #ECEEEF;padding-top: 15px;padding-bottom: 15px;padding-left: 13px;}.uagb-block-188fea4d.uagb-layout-input-button .uagb-search-wrapper .uagb-search-form__container .uagb-search-submit{background-color: #9d9d9d;}@media only screen and (max-width: 976px) {.uagb-block-188fea4d .uagb-search-wrapper .uagb-search-form__container .uagb-search-form__input{padding-top: 15px;padding-bottom: 15px;padding-right: 13px;padding-left: 13px;}.uagb-block-188fea4d .uagb-search-form__container .uagb-wp-search-icon-wrap{padding-top: 15px;padding-bottom: 15px;padding-left: 13px;}}@media only screen and (max-width: 767px) {.uagb-block-188fea4d .uagb-search-wrapper .uagb-search-form__container .uagb-search-form__input{padding-top: 15px;padding-bottom: 15px;padding-right: 13px;padding-left: 13px;}.uagb-block-188fea4d .uagb-search-form__container .uagb-wp-search-icon-wrap{padding-top: 15px;padding-bottom: 15px;padding-left: 13px;}}</style>
<link rel="icon" href="/wp-content/uploads/2020/09/logo.png" sizes="32x32">
<link rel="icon" href="/wp-content/uploads/2020/09/logo.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wp-content/uploads/2020/09/logo.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2020/09/logo.png">
</head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161935417-3"></script>
<script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161935417-3');</script>
<body class="archive category category-sdk category-71 wp-custom-logo has-sidebar has-header-image">
<div id="page" class="hfeed site">
		<div id="widgets-wrapper" class="hide">
		
<div id="secondary" class="wrap top-widget-area" role="complementary">
		<div id="sidebar-1" class="widget-area" role="complementary">
		<aside id="block-9" class="widget widget_block"><p><script async="" src="https://cse.google.com/cse.js?cx=df8210082ba786774"></script></p>
<div class="gcse-search"></div></aside><aside id="block-10" class="widget widget_block widget_media_image"><div class="wp-block-image">
<figure class="aligncenter size-full"><img fetchpriority="high" decoding="async" width="748" height="99" src="/wp-content/uploads/2023/07/a-seach.png" alt="" class="wp-image-11535"></figure>
</div></aside>	</div>
<!-- #first .widget-area -->
	
	
	
	</div>
<!-- #secondary -->
	</div>
	
	<a class="skip-link screen-reader-text" href="#content">コンテンツへ移動</a>

	<header id="masthead" class="site-header" role="banner">
					<a class="site-logo" href="/" title="JunkHack" rel="home noopener noreferrer" data-wpel-link="internal">
				<img src="https://secure.gravatar.com/avatar/997681319c3cbb0bdcca95770d5edaa6/?s=80&#038;d=mm" width="80" height="80" alt="" class="no-grav header-image">
			</a>
		
		<div class="site-branding">
			<h1 class="site-title"><a href="/" rel="home noopener noreferrer" data-wpel-link="internal">JunkHack</a></h1>
			<h2 class="site-description">アリエクでポチった JUNKHACK</h2>
		</div>

					<nav id="site-navigation" class="main-navigation" role="navigation">
				<button class="menu-toggle toggle-button"><span class="screen-reader-text">メインメニュー</span></button>
				<div class="menu-new-menu-container"><ul id="menu-new-menu" class="menu">
<li id="menu-item-10686" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10686"><a href="/list/" data-wpel-link="internal" rel="noopener noreferrer">List</a></li>
<li id="menu-item-11016" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-11016"><a href="/mail/" data-wpel-link="internal" rel="noopener noreferrer">CONTACT</a></li>
<li id="menu-item-10671" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-10671"><a href="https://mirror.gpl.jp/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">Mirror<span class="wpel-icon wpel-image wpel-icon-1"></span></a></li>
</ul></div>			</nav><!-- #site-navigation -->
		
		
				<div class="toggle-wrapper">
			<a href="#" class="widgets-toggle toggle-button" title="ウィジェット">
				<span class="screen-reader-text">ウィジェット</span>
			</a>
		</div>
		
	</header><!-- #masthead -->
	
	<div id="content" class="site-content">
	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">カテゴリー: <span>sdk</span>
</h1>			</header><!-- .page-header -->

						
				
<article id="post-1280" class="post-1280 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-pcb category-sdk">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="/2015/09/28/espeink-%e3%81%ae%e7%8f%be%e5%9c%a8%e3%81%ae%e8%aa%bf%e6%9f%bb%e7%8a%b6%e6%b3%81/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-09-28T01:49:32+09:00">2015年9月28日</time></a> </span><span class="posted-on">更新日:2015年9月28日</span> <span class="categories">  <a href="/category/esp8266/" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="/category/espeink/" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="/category/pcb/" rel="category tag noopener noreferrer" data-wpel-link="internal">PCB</a>, <a href="/category/sdk/" rel="category tag noopener noreferrer" data-wpel-link="internal">sdk</a></span>			</div>
<!-- .entry-meta -->

							<h1 class="entry-title"><a href="/2015/09/28/espeink-%e3%81%ae%e7%8f%be%e5%9c%a8%e3%81%ae%e8%aa%bf%e6%9f%bb%e7%8a%b6%e6%b3%81/" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink の現在の調査状況</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>とりあえず、問題点となるポイントが絞れてきました。</p>
<p>設定を終えて、再度起動するときに以下のようになります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">deep sleep 60s

þárl.l&#156;&#158;|.&#140;là|....&#140;.lì.b|&#142;&#130;.ì.&#146;r&#146;b&#140;.b&#140;ònn&#158;lnn&#156;âì.b.p&#140;&#142;lrlrlpònà....&#130;.l......b.nâ|.&#140;ll..&#142;b&#140;ònnî.l&#140;&#142;l`.&#144;..nn.l`...nr&#142;&#146;&#146;n...l&#156;.lpònà....r&#140;&#156;&#156;âà....b.nâ|.&#140;&#140;&#142;.à.b&#140;ònnî...l`.&#144;..nnl&#140;l`...nr&#142;&#146;&#146;n..r&#140;&#146;`.`òn...&#158;àb&#130;nl&#140;.&#140;ònnî..&#142;.lpònà....r&#140;&#156;&#156;âàl&#146;..b.nâ|.ììì&#140;&#142;b&#140;ònnî.l&#140;.l`.&#144;..nnl&#140;l`...nr&#142;&#146;&#146;n..&#130;òl`..r&#146;&#146;n..&#130;òl`.är.Datasource http://192.168.1.17/server/espbm.php
mode : sta(18:fe:34:9b:99:a3)
add if0
scandone
add 0
aid 4
pm open phy_2,type:2 0 0
cnt 

connected with JunkHackAP, channel 6
dhcp client start...
ip:192.168.1.24,mask:255.255.255.0,gw:192.168.1.1
Wdt. This takes too long. Go to sleep.
rm match
pm close 7 0 0/19987670
deep sleep 60s

.árl.l&#156;&#158;|.&#140;là|....&#140;.lì.b|&#142;&#130;.ì.&#146;r&#146;b&#140;.b&#140;ònn&#158;lnn&#156;âì.b.p&#140;&#142;lrlrlpònà....&#130;.l......b.nâ|.&#140;ll..&#142;b&#140;ònnî.l&#140;&#142;l`.&#144;..nn.l`...nr&#142;&#146;&#146;n...l&#156;.lpònà....r&#140;&#156;&#156;âà....b.nâ|.&#140;&#140;&#142;.à.b&#140;ònnî...l`.&#144;..nnl&#140;l`...nr&#142;&#146;&#146;n..r&#140;&#146;`.`òn...&#158;àb&#130;nl&#140;.&#140;ònnî..&#142;.lpònà....r&#140;&#156;&#156;âàl&#146;..b.nâ|.ììì&#140;&#142;b&#140;ònnî.l&#140;.l`.&#144;..nnl&#140;l`...nr&#142;&#146;&#146;n..&#130;òl`..r&#146;&#146;n..&#130;òl`.är.Datasource http://192.168.1.17/server/espbm.php
mode : sta(18:fe:34:9b:99:a3)
add if0
scandone
add 0
aid 4
pm open phy_2,type:2 0 0
cnt 

connected with JunkHackAP, channel 6
dhcp client start...
ip:192.168.1.24,mask:255.255.255.0,gw:192.168.1.1
Wdt. This takes too long. Go to sleep.
rm match
pm close 7 0 0/19987656
deep sleep 60s

þá</pre>
<p>これは、DHCP でIP を取得するまえに、データソースのURL をフェッチしにいっているようで、WiFi のコネクトチェックがアボートしているので、URLにコネクトしていない状況です。どういうタイミングかはわかりませんが、極まれに以下のようになるときがあります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">deep sleep 60s

.árl.l&#156;&#158;|.&#140;là|....&#140;.lì.b|&#142;&#130;.ì.&#146;r&#146;b&#140;.b&#140;ònn&#158;lnn&#156;âì.b.pì&#142;lrlrlpònà....&#130;.l......b.nâ|.ìll&#142;&#142;&#142;b&#140;ònnî.l&#140;&#142;l`.&#144;..nn.l`...nr&#142;&#146;&#146;n..&#146;l&#142;.lpònà....r&#140;&#156;&#156;âà....b.nâ|.&#140;.&#142;&#142;&#142;b&#140;ònnî...l`.&#144;..nnl&#140;l`...nr&#142;&#146;&#146;n..&#130;&#140;&#142;.l`òn...&#158;àb&#130;nl&#140;.&#140;ònnî..&#142;.lpònà....r&#140;&#156;&#156;âàl&#140;..b.nâ|.ìl&#142;.à.b&#140;ònnî.l&#140;.l`.&#144;..nnl&#140;l`...nr&#142;&#146;&#146;n..ò.&#156;.l.r&#146;&#146;n..ò.&#156;.lärlDatasource http://192.168.1.17:8266/server/espbm.php
mode : sta(18:fe:34:9b:99:a3)
add if0
scandone
reconnect
scandone
reconnect
scandone
reconnect
scandone
reconnect
scandone
reconnect
scandone
reconnect
scandone
reconnect
scandone
reconnect
scandone
add 0
aid 4
pm open phy_2,type:2 0 0
cnt 

connected with JunkHackAP, channel 6
dhcp client start...
No heap available, failed to malloc 440
No heap available, failed to malloc 440
Wdt. This takes too long. Go to sleep.
rm match
pm close 7 0 0/10213903
No heap available, failed to malloc 440
del if0
usl
sul 0 0
deep sleep 60s

.á</pre>
<p>現在までで、SDK はとりあえず以下で調査しました。</p>
<table cellspacing="0" cellpadding="2" width="600" border="0">
<tbody>
<tr>
<td valign="top" width="99">SDK Version</td>
<td valign="top" width="104">make可否</td>
<td valign="top" width="246">make問題点</td>
<td valign="top" width="83">実際の挙動</td>
<td valign="top" width="68">備考</td>
</tr>
<tr>
<td valign="top" width="99">0.9.2</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">&#160;</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">0.9.3</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">&#160;</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">0.9.5</td>
<td valign="top" width="104">O</td>
<td valign="top" width="246">なし</td>
<td valign="top" width="83">URL フェッチしない</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">0.9.6_b1</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">unknown type name &#8216;uint32_t&#8217;<br>
        <br>unknown type name &#8216;uint16_t&#8217;
<p>unknown type name &#8216;uint8_t&#8217;</p>
</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">cgiwifi.c<br>
        <br>io.h</td>
</tr>
<tr>
<td valign="top" width="99">1.0.0</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">同上</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">1.0.1b1</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">同上</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">1.0.1b2</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">同上</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">1.0.1</td>
<td valign="top" width="104">O</td>
<td valign="top" width="246">なし</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">1.1.0</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">eink.c で使われている<br>
        <br>os_update_cpu_frequency
<p>がこのSDKにない</p>
</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">v1.1.0_15_05_26</td>
</tr>
<tr>
<td valign="top" width="99">1.1.1</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">unknown type name &#8216;uint**_t&#8217;<br>
        <br>conflicting types for &#8216;os_random&#8217;
<p></p>
</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">user/cgiwifi.c<br>
        <br>user/io.h
<p>include/espmissingincludes.h</p>
</td>
</tr>
<tr>
<td valign="top" width="99">1.1.2</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">同上</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">同上</td>
</tr>
<tr>
<td valign="top" width="99">1.2.0</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">同上</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">同上</td>
</tr>
<tr>
<td valign="top" width="99">1.3.0</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">&#160;</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
<tr>
<td valign="top" width="99">1.4.0</td>
<td valign="top" width="104">X</td>
<td valign="top" width="246">&#160;</td>
<td valign="top" width="83">&#160;</td>
<td valign="top" width="68">&#160;</td>
</tr>
</tbody>
</table>
<p>※随時、更新予定。</p>
<p>&#160;</p>
<p>SDK のバージョンがあがるごとに、廃止されたファンクションがあったり、引数が変わったりしたものがあったりと、それなりに対応が必要そうです。作者はおそらく、推測ですが0.9.5 あたりで作成しているかと思います。</p>
<p>&#160;</p>
<p>esp-open-sdk の makefile を見ると以下のようにあり、まだ試すバージョンがあります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">VENDOR_SDK_ZIP_1.3.0 = esp_iot_sdk_v1.3.0_15_08_08.zip
VENDOR_SDK_DIR_1.3.0 = esp_iot_sdk_v1.3.0
VENDOR_SDK_ZIP_1.2.0 = esp_iot_sdk_v1.2.0_15_07_03.zip
VENDOR_SDK_DIR_1.2.0 = esp_iot_sdk_v1.2.0
VENDOR_SDK_ZIP_1.1.2 = esp_iot_sdk_v1.1.2_15_06_12.zip
VENDOR_SDK_DIR_1.1.2 = esp_iot_sdk_v1.1.2
VENDOR_SDK_ZIP_1.1.1 = esp_iot_sdk_v1.1.1_15_06_05.zip
VENDOR_SDK_DIR_1.1.1 = esp_iot_sdk_v1.1.1
VENDOR_SDK_ZIP_1.1.0 = esp_iot_sdk_v1.1.0_15_05_26.zip
VENDOR_SDK_DIR_1.1.0 = esp_iot_sdk_v1.1.0
# MIT-licensed version was released without changing version number
#VENDOR_SDK_ZIP_1.1.0 = esp_iot_sdk_v1.1.0_15_05_22.zip
#VENDOR_SDK_DIR_1.1.0 = esp_iot_sdk_v1.1.0
VENDOR_SDK_ZIP_1.0.1 = esp_iot_sdk_v1.0.1_15_04_24.zip
VENDOR_SDK_DIR_1.0.1 = esp_iot_sdk_v1.0.1
VENDOR_SDK_ZIP_1.0.1b2 = esp_iot_sdk_v1.0.1_b2_15_04_10.zip
VENDOR_SDK_DIR_1.0.1b2 = esp_iot_sdk_v1.0.1_b2
VENDOR_SDK_ZIP_1.0.1b1 = esp_iot_sdk_v1.0.1_b1_15_04_02.zip
VENDOR_SDK_DIR_1.0.1b1 = esp_iot_sdk_v1.0.1_b1
VENDOR_SDK_ZIP_1.0.0 = esp_iot_sdk_v1.0.0_15_03_20.zip
VENDOR_SDK_DIR_1.0.0 = esp_iot_sdk_v1.0.0
VENDOR_SDK_ZIP_0.9.6b1 = esp_iot_sdk_v0.9.6_b1_15_02_15.zip
VENDOR_SDK_DIR_0.9.6b1 = esp_iot_sdk_v0.9.6_b1
VENDOR_SDK_ZIP_0.9.5 = esp_iot_sdk_v0.9.5_15_01_23.zip
VENDOR_SDK_DIR_0.9.5 = esp_iot_sdk_v0.9.5
VENDOR_SDK_ZIP_0.9.4 = esp_iot_sdk_v0.9.4_14_12_19.zip
VENDOR_SDK_DIR_0.9.4 = esp_iot_sdk_v0.9.4
VENDOR_SDK_ZIP_0.9.3 = esp_iot_sdk_v0.9.3_14_11_21.zip
VENDOR_SDK_DIR_0.9.3 = esp_iot_sdk_v0.9.3
VENDOR_SDK_ZIP_0.9.2 = esp_iot_sdk_v0.9.2_14_10_24.zip
VENDOR_SDK_DIR_0.9.2 = esp_iot_sdk_v0.9.2</pre>
<p>0.9.5 ～ 1.3.0 の間にまだあるので、それらをとりあえず全部試してみようかと。</p>
<p>コードの調査している部分は、</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- user_main.c
::
    httpclientFetch(myConfig.url, httpclientCb, httpclientHdrCb);
    
    einkDisplay(24*1024, tcpEinkNeedData, einkDoneCb);
::</pre>
<p>です。古典的に、デバックにはシリアルプリントと delay を入れているんですが、コネクトしている部分がよくわからず、一体どこで、アクセスポイントに接続して、dhcp してIP をもらっているのかが良くわかっていません。このあたりは、C のデバックデックニックのスキルだと思いますが、もっと効率的なものはないでしょうかね。</p>
<p>&#160;</p>
<p>原理的に、deep sleep から復帰したら、まずアクセスポイントにコネクトし、IP をゲットするまで delay させてからフェッチしたいんですが、そのdelay を入れるところがよくわかりません。</p>
<p>&#160;</p>
<p>もう少し、簡単なアクセスポイントに接続するコードを書いて試してみようかと思います。部品とプリント基板を発注しようと考えていたんですが、もう少しソースコードを調査しないと動作しなさそうなので、来週以降に発注は持ち越しになりそうです。httpのtcp 経由じゃなく、ローカルのファイルシステム（espfs）に含まれる.bm ファイルは表示されている感じなので、表示することはできそうかなと思います。</p>
<p>&#160;</p>
<p>さぁ、どこまで根気が続くかです。hack とは根気がいるものですね。推理と実験を繰り返し、１つづつ問題を把握しないといけませんが、問題を分解するのにスキルが足りていない部分は都度、勉強しながらとなるので、時間がかかります。</p>
<p>今のところ、このhack で勉強になったのは、基板を設計しお値打ちに作成する方法、open-sdk というものがあること、esptool にはpython 版と C 版があるということです。</p>
<p>&#160;</p>
<p>▼まとめ</p>
<p>・作者はおそらく、0.9.5 か 1.0.1のSDK を使っていたと推測。</p>
<p>・esphttpd は、オリジナルがおそらく以下</p>
<p><a title="https://github.com/OLIMEX/ESP8266/tree/master/esphttpd" href="https://github.com/OLIMEX/ESP8266/tree/master/esphttpd" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/OLIMEX/ESP8266/tree/master/esphttpd<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>・そして、最新のSDKなどにあわせて新しくなったものが以下にある</p>
<p><a title="https://github.com/izhak2/esphttpd" href="https://github.com/izhak2/esphttpd" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/izhak2/esphttpd<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>・この単体をまず試してみようと思う。特に、新しいesphttpd は Makefile の書き方が参考になるし、新しいSDKにも対応しているようなので。</p>
					</div>
<!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div>
<!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-1277" class="post-1277 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-sdk">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="/2015/09/27/espeink-%e3%81%ae%e6%8c%99%e5%8b%95/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-09-27T02:17:42+09:00">2015年9月27日</time></a> </span><span class="posted-on">更新日:2015年9月27日</span> <span class="categories">  <a href="/category/esp8266/" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="/category/espeink/" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="/category/sdk/" rel="category tag noopener noreferrer" data-wpel-link="internal">sdk</a></span>			</div>
<!-- .entry-meta -->

							<h1 class="entry-title"><a href="/2015/09/27/espeink-%e3%81%ae%e6%8c%99%e5%8b%95/" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink の挙動</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>とりあえず、全体がまだ良くわかっていないけれども、E-ink とストリームするサーバが必要だということはわかったので、そのメモです。</p>
<p>&#160;</p>
<p>ファームウェアの user/config.c 中にあるURL を以下のように書き換えて、ファームウェアをアップ。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- user/config.c
::
void configLoad() {
    int c;
    spi_flash_read(ESP_PARAM_SEC*SPI_FLASH_SEC_SIZE, (uint32 *)&amp;myConfig, sizeof(MyConfig));
    c=calcChsum();
    if (c!=myConfig.chsum) {
        // os_strcpy(myConfig.url, &quot;http://meuk.spritesserver.nl/espbm.php&quot;);
        os_strcpy(myConfig.url, &quot;http://192.168.1.17:8266/server/espbm.php&quot;);
    }
}
::</pre>
<p>192.168.1.17:8266 は、とりあえずosx で起動しているapache です。</p>
<p>本来、mode が 3 で最初に起動するときは動作し、アクセスポイントに接続したら 192.168.4.1 でアクセスできるはずなんだろうけども、そのアクセスポイントに入るパスワードが良くわからず、ソースコード中でとりあえずアクセスポイントに接続するようにしてみた。そして、esp12 に他のブラウザからアクセスしてみたのが以下。</p>
<p><img decoding="async" title="WiFi_connection" style="border-top:0;border-right:0;border-bottom:0;float:none;margin-left:auto;border-left:0;display:block;margin-right:auto;" border="0" alt="WiFi_connection" src="/wp-content/uploads/2015/09/wifi_connection.png" width="640" height="325"> </p>
<p>&#160;</p>
<p>Datasource の URL にあるespbm.php はおそらく、.bm をストリームするものだと思うけれども、サンプルファイル中にはなく、とりあえず変換済みの.bm ファイルにリダイレクトするものを用意。具体的には、以下のようなもの。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">&lt;?php
fpassthru(fopen(&quot;../html/apconnect.bm&quot;, &quot;r&quot;));
exit(0);
?&gt;</pre>
<p>これが正しいのかどうかは、今のところ不明ですが、こうしてみると、シリアル通信は、以下のようになります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">★Reset 後の UART の内容
::

 ets Jan  8 2013,rst cause:4, boot mode:(3,7)

wdt reset
load 0x40100000, len 31640, room 16 
tail 8
chksum 0x70
load 0x3ffe8000, len 2572, room 0 
tail 12
chksum 0x06
ho 0 tail 12 room 4
load 0x3ffe8a10, len 3528, room 12 
tail 12
chksum 0x7d
csum 0x7d
rlDatasource http://192.168.1.17:8266/server/espbm.php
mode : sta(18:fe:34:9b:99:a3)
add if0
scandone
reconnect
scandone
add 0
aid 5
pm open phy_2,type:2 0 0
cnt 

connected with JunkHackAP, channel 6
dhcp client start...
No heap available, failed to malloc 440★ヒープがないとさ。IPがとれていない
Wdt. This takes too long. Go to sleep.
del if0
usl
sul 3 0
rm mismatch
pm close 7 0 0/17956334
deep sleep 60s★一回スリープするが、

.árl.l&#156;&#158;|.&#140;là|....&#140;.lì.b|&#142;&#130;.ì.&#146;r&#146;bl&#142;b&#140;ònn&#158;lnn&#156;âì.b.pì&#142;lrlrl.&#130;rò&#146;nàbânbp.ü
★60秒後に起きた時には動作せず。</pre>
<p>うーん、おしいところまではきていますが、何かがおかしいですね。</p>
<p>テストのために、ソースコードには以下の変更がしてあります。</p>
<p>1) 3.1V 以下でも動作するように定数を書き換え</p>
<p>2) 初回 mode(3) のアクセスポイントに入るパスワードが不明で、接続するよう設定してある</p>
<p>&#160;</p>
<p>なんか、2の変更がまずそうかもしれません。</p>
<p>まぁ、でもここまでで、以下の事が、ぼやっとですがわかりました。</p>
<p>&#160;</p>
<p>▼まとめ</p>
<p>・ESP12 から表示するURLは指定でき、そこから画像をストリームして表示しているだろう。</p>
<p>・ESP12 に表示させる画像は、別サーバから取得していることがわかった。</p>
<p>・初回ブートかどうかを判別させる、RTC_MAGICコード部分はうまく動作している</p>
<p>・初回アクセスポイントの設定に行ったとき、開発ボードのLED は光り、画像出力pin へはデータが流れているようだ。</p>
<p>&#160;</p>
<p>▼不明なこと</p>
<p>・前回不明だったことがまだクリアされていない。</p>
<blockquote>
<p>・最初の起動時に、192.168.4.1 で mode(3) のステーションで起動してくるが、このときのwifi アクセスポイントに入るパスワードは？ </p>
<p>・EPS12 が設定を終えれば、定期間隔でWEB サーバを見に行くが、この処理はどうやればいいのか？</p>
</blockquote>
<p>最初の部分は、ESP8266 の挙動を知れば解決できるかもしれないです。wifi_set_opmode(3); からリスタートがかかるときの挙動というか、サンプルにあるWEBサーバの挙動がどうなるか調査することに。</p>
<p>後者は、推測なのでなんとも言えないのですが、今のところ以下のように考えています。</p>
<p>・800&#215;600 の画像を.bm の形式でストリームさせる。png を bm に変換させるサンプルスクリプトは、ソースコード中のmkimg.php がそれです。出力画像の部分をストリームさせればいいかと。どんなhttpヘッダーをつければいいのですかね？</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">&lt;?php

//Small script to convert an 800x600 png into a .bm file the
//eink display can render from its internal espfs.

function convertImage($file, $out) {
    $im=imagecreatefrompng($file);
    $of=fopen($out, &quot;w&quot;);
    for ($y=0; $y&lt;600; $y++) {
        for ($x=0; $x&lt;800; $x+=8) {
            $b=0;
            for ($z=0; $z&lt;8; $z++) {
                $b&lt;&lt;=1;
                $c=imagecolorat($im, $x+$z, $y);
                if ((($c)&amp;0xff)&lt;0x80) $b|=1;
            }
            fprintf($of, &quot;%c&quot;, $b);
        }
    }
    imagedestroy($im);
    fclose($of);
}

convertImage(&quot;icons/apconnect.png&quot;, &quot;html/apconnect.bm&quot;);
//convertImage(&quot;★ソース画像&quot;, &quot;★出力画像&quot;);

?&gt;</pre>
					</div>
<!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div>
<!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-1269" class="post-1269 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-sdk">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="/2015/09/26/espeink-make-%e3%81%9d%e3%81%ae%ef%bc%94/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-09-26T21:51:15+09:00">2015年9月26日</time></a> </span><span class="posted-on">更新日:2015年9月26日</span> <span class="categories">  <a href="/category/esp8266/" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="/category/espeink/" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="/category/sdk/" rel="category tag noopener noreferrer" data-wpel-link="internal">sdk</a></span>			</div>
<!-- .entry-meta -->

							<h1 class="entry-title"><a href="/2015/09/26/espeink-make-%e3%81%9d%e3%81%ae%ef%bc%94/" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink make その４</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>続きをやっています。昨日、esptool は C 製のを使うことがわかったので今回は実際に ESP12 に書き込んでみます。</p>
<p>まだ、PCB ボードは作っていませんが、開発ボードにとりあえず書き込めるかやってみようと思います。</p>
<p>&#160;</p>
<p>書き込む開発ボードは、以下のものです。他2台は、以前にあれこれやっている最中に3.3V 以上入れすぎて壊れたようです。2台は昇天しましたので、正常なのはこれと、あと未開封のが１つあります。</p>
<p> <img decoding="async" title="dev" style="float:none;margin-left:auto;display:block;margin-right:auto;border-width:0;" border="0" alt="dev" src="/wp-content/uploads/2015/09/dev.jpg" width="640" height="480">   </p>
<p>&#160;</p>
<p>さて、ソースディレクトリに移動し、make flash してみます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ make flash
esptool vb64eebd - (c) 2014 Ch. Klippel &lt;ck@atelier-klippel.de&gt;
opening port /dev/cu.SLAB_USBtoUART at 115200
opening bootloader
resetting board
trying to connect
trying to connect
Uploading 37632 bytes from firmware/0x00000.bin to flash at 0x00000000
.....................................
starting app without reboot
closing bootloader
Please put the ESP in bootloader mode...★再度、RST を GND に
esptool vb64eebd - (c) 2014 Ch. Klippel &lt;ck@atelier-klippel.de&gt;
opening port /dev/cu.SLAB_USBtoUART at 115200
opening bootloader
resetting board
trying to connect
trying to connect
Uploading 166264 bytes from firmware/0x40000.bin to flash at 0x00040000
...................................................................................................................................................................
starting app without reboot
closing bootloader
HOPE:espeink junkhack$ </pre>
<p>&#160;</p>
<p>こんな感じになれば書き込みはOK なようです。</p>
<p>esptool(esptool-ck) が、ファームウェアが２つ書き込むのですが、2つ目の時にも再度書き込みモードを要求してくるようなので、RST pin をGNDに落としてブートモードにします。このあたりは、実際のPCB 基盤につけた状態だとどうなるのでしょうかね？要検討です。</p>
<p>&#160;</p>
<p>続いて、html を mkespfsimage というツールを使って圧縮しそれを 0x12000 の領域に書き込むようです。これは、以下のコマンドを使って作ることができます。</p>
<blockquote>
<p>$ make webpages.espfs</p>
</blockquote>
<p>が、ここで問題が２つ発生。まず、osx だと、これを実行すると、昨日試したように、</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ make webpages.espfs
cd html; find | ../mkespfsimage/mkespfsimage &gt; ../webpages.espfs; cd ..
/bin/sh: ../mkespfsimage/mkespfsimage: cannot execute binary file
usage: find [-H | -L | -P] [-EXdsx] [-f path] path ... [expression]
       find [-H | -L | -P] [-EXdsx] -f path [path ...] [expression]
HOPE:espeink junkhack$</pre>
<p>&#160;</p>
<p>となってしまいfind の使い方が悪いよと、出てしまいます。make ファイルに書いてあるようにコマンドを実行してみますと</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ cd html/
HOPE:html junkhack$ find
usage: find [-H | -L | -P] [-EXdsx] [-f path] path ... [expression]
       find [-H | -L | -P] [-EXdsx] -f path [path ...] [expression]</pre>
<p>&#160;</p>
<p>となります。osx の find は、引数を与えないとデフォルトでは出ない仕様のようです。なので、GNU の find を入れます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ brew install findutils --with-default-names</pre>
<p>&#160;</p>
<p>まず、1つ目の問題はこれでクリアです。しかし、まだ以下のようになります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ make webpages.espfs
cd html; find | ../mkespfsimage/mkespfsimage &gt; ../webpages.espfs; cd ..
/bin/sh: ../mkespfsimage/mkespfsimage: cannot execute binary file</pre>
<p>&#160;</p>
<p>シェルが、mkespfsimage の、バイナリファイルを実行できないようです。このコマンドを再度 make してみます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:mkespfsimage junkhack$ cd mkespfsimage

HOPE:mkespfsimage junkhack$ make clean
rm -f mkespfsimage main.o heatshrink_encoder.o
HOPE:mkespfsimage junkhack$ 

HOPE:mkespfsimage junkhack$ make
cc -I../lib/heatshrink -std=gnu99   -c -o main.o main.c
main.c:59:38: warning: passing 'char *' to parameter of type 'uint8_t *' (aka 'unsigned char *') converts between pointers to integer types with
      different sign [-Wpointer-sign]
                        sres=heatshrink_encoder_sink(enc, inp, insize, &amp;len);
                                                          ^~~
../lib/heatshrink/heatshrink_encoder.h:97:14: note: passing argument to parameter 'in_buf' here
    uint8_t *in_buf, size_t size, size_t *input_size);
             ^
main.c:65:38: warning: passing 'char *' to parameter of type 'uint8_t *' (aka 'unsigned char *') converts between pointers to integer types with
      different sign [-Wpointer-sign]
                        pres=heatshrink_encoder_poll(enc, outp, outsize, &amp;len);
                                                          ^~~~
../lib/heatshrink/heatshrink_encoder.h:102:14: note: passing argument to parameter 'out_buf' here
    uint8_t *out_buf, size_t out_buf_size, size_t *output_size);
             ^
2 warnings generated.
cc -I../lib/heatshrink -std=gnu99   -c -o heatshrink_encoder.o heatshrink_encoder.c
cc -o mkespfsimage main.o heatshrink_encoder.o
HOPE:mkespfsimage junkhack$</pre>
<p>&#160;</p>
<p>とりあえず、なんか警告は出ていますができたようです。Linux (Ubuntu)のgcc 4.8.2では以下のようになりました。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">root@ub:~/work/espeink/mkespfsimage# rm mkespfsimage
root@ub:~/work/espeink/mkespfsimage# make clean
rm -f mkespfsimage main.o heatshrink_encoder.o
root@ub:~/work/espeink/mkespfsimage# 
root@ub:~/work/espeink/mkespfsimage# make
cc -I../lib/heatshrink -std=gnu99   -c -o main.o main.c
cc -I../lib/heatshrink -std=gnu99   -c -o heatshrink_encoder.o heatshrink_encoder.c
cc -o mkespfsimage main.o heatshrink_encoder.o
root@ub:~/work/espeink/mkespfsimage# </pre>
<p>&#160;</p>
<p>osx では、gcc に以下を使っていたので出たようです。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:mkespfsimage junkhack$ gcc --version
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn)
Target: x86_64-apple-darwin13.4.0
Thread model: posix</pre>
<p>&#160;</p>
<p>とりあえず、警告は出ていますが、ビルドはされているようなので、スルーします。さて、これで2番目の問題も解決できたはずです。実行してみますと、以下のようになりました。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ make webpages.espfs
cd html; find | ../mkespfsimage/mkespfsimage &gt; ../webpages.espfs; cd ..
140medley.min.js (74%)
apconnect.bm (15%)
batempty.bm (13%)
connecting.html (95%)
icons.png (100%)
neterror.bm (16%)
style.css (73%)
wifi.tpl (54%)
HOPE:espeink junkhack$ 

HOPE:espeink junkhack$ ll
total 120
-rw-r--r--@  1 junkhack  staff   4946  9 24 21:27 Makefile
-rw-r--r--@  1 junkhack  staff   3261  9 23 15:34 Makefile.patch
-rw-r--r--@  1 junkhack  staff   4960  9 11 00:13 Makefile_org
-rw-r--r--@  1 junkhack  staff    207  9 22 22:32 README
drwxr-xr-x   6 junkhack  staff    204  9 24 21:31 build
drwxr-xr-x   4 junkhack  staff    136  9 24 21:31 firmware
drwxr-xr-x  10 junkhack  staff    340  9 22 22:32 html
drwxr-xr-x   5 junkhack  staff    170  9 22 22:32 icons
drwxr-xr-x  10 junkhack  staff    340  9 22 22:32 include
drwxr-xr-x   3 junkhack  staff    102  9 22 22:32 lib
drwxr-xr-x   9 junkhack  staff    306  9 26 22:08 mkespfsimage
-rw-r--r--   1 junkhack  staff    638  9 22 22:32 mkimg.php
drwxr-xr-x   4 junkhack  staff    136  9 22 22:32 server
drwxr-xr-x  24 junkhack  staff    816  9 22 22:32 user
-rw-r--r--   1 junkhack  staff  31024  9 26 22:17 webpages.espfs★
HOPE:espeink junkhack$</pre>
<p>&#160;</p>
<p>★のファイルが生成されていればOK です。</p>
<p>なるほど、これでesp12 の中に入っているweb サーバがこのファイルシステムの中のファイルを読んで表示しているんですね。</p>
<p>やっとこれでhtml が書き込めるはずです。以下のようになりました。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ make htmlflash
if [ $(stat -c '%s' webpages.espfs) -gt $(( 0x2E000 )) ]; then echo &quot;webpages.espfs too big!&quot;; false; fi
stat: illegal option -- c
usage: stat [-FlLnqrsx] [-f format] [-t timefmt] [file ...]
/bin/sh: line 0: [: -gt: unary operator expected
esptool -cp /dev/cu.SLAB_USBtoUART -cb 115200 -ca 0x12000 -cf webpages.espfs -v
esptool vb64eebd - (c) 2014 Ch. Klippel &lt;ck@atelier-klippel.de&gt;
opening port /dev/cu.SLAB_USBtoUART at 115200
opening bootloader
resetting board
trying to connect
trying to connect
Uploading 31024 bytes from webpages.espfs to flash at 0x00012000
...............................
starting app without reboot
closing bootloader
HOPE:espeink junkhack$ </pre>
<p>&#160;</p>
<p>書き込めてはいるようですが、最初の部分で stat の使い方が悪そうと出ています。おそらくこれは、ファイルがでか過ぎないかどうかを見ているんだと思いますが、とりあえずスルーします。</p>
<p>あとは設定とか、WiFi E-ink とそれを見に行くサーバの設定などとなるはずです。</p>
<p>&#160;</p>
<p>▼まとめ</p>
<p>・ESP12 で動作するWEB は、圧縮されたファイルシステムの中のファイルを見に行く</p>
<p>・そのファイルは、mkespfsimage で heatshrink を使った圧縮で作成される</p>
<p>・osx の find はデフォルト引数なしだと、動作しないので、gnu 版を入れる</p>
<p>・mkspsimage コマンドは、再度コンパイルする。</p>
<p>・ESP12 への書き込みは、ファームウェアは、make flash で書き込む</p>
<p>・ESP12 へのhtml ファイルの書き込みは、make htmlflash を使う</p>
<p>・make htmlflash を使ったとき、ファイルサイズの大きさをチェックしているようですがこれがosx では、動作していない模様</p>
<p>・おそらく書き込みには、Linux を使ったほうが楽です。</p>
<p>&#160;</p>
<p>まだ、良くわからないことがありますが、それは追って調査します。</p>
<p>▼良くわからないこと</p>
<p>・最初の起動時に、192.168.4.1 で mode(3) のステーションで起動してくるが、このときのwifi アクセスポイントに入るパスワードは？</p>
<p>・EPS12 が設定を終えれば、定期間隔でWEB サーバを見に行くが、この処理はどうやればいいのか？</p>
<p>&#160;</p>
<p>推測では、画像のURL を指定すればいける気がします。その画像ファイルは、bm 形式のもので。このあたりは、もう少し調査しないと白黒言えませんが、なんとかいけそうな気がしてきましたので、部品を発注したり、基板を発注したりするかどうか考えて見ます。実際のボードとE-ink ディスプレイがないとこれ以上の確認はちょっと厳しいです。できなくはないですが、あとは現場合わせで楽しんでもいいかなぁと。</p>
					</div>
<!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div>
<!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-1261" class="post-1261 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-sdk">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="/2015/09/25/espeink-make-%e3%81%9d%e3%81%ae%ef%bc%93/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-09-25T04:39:37+09:00">2015年9月25日</time></a> </span><span class="posted-on">更新日:2015年9月25日</span> <span class="categories">  <a href="/category/esp8266/" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="/category/espeink/" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="/category/sdk/" rel="category tag noopener noreferrer" data-wpel-link="internal">sdk</a></span>			</div>
<!-- .entry-meta -->

							<h1 class="entry-title"><a href="/2015/09/25/espeink-make-%e3%81%9d%e3%81%ae%ef%bc%93/" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink make その３</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>さて、その後esptool っていうのを調査しました。 </p>
<p>Makefile には、-eo や、2番目の引数の変数に展開される –bo や –bs などがあります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- Makefile
::
# we create two different files for uploading into the flash
# these are the names and options to generate them
FW_FILE_1    = 0x00000
FW_FILE_1_ARGS    = -bo $@ -bs .text -bs .data -bs .rodata -bc -ec
FW_FILE_2    = 0x40000
FW_FILE_2_ARGS    = -es .irom0.text $@ -ec
::
$(FW_FILE_1): $(TARGET_OUT) firmware
    $(vecho) &quot;FW $@&quot;
    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_1_ARGS)★
::</pre>
<p>&#160;</p>
<p>python の esptool.py の引数をチェックしてみると </p>
<blockquote>
<p><a href="https://github.com/themadinventor/esptool/blob/master/esptool.py" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/themadinventor/esptool/blob/master/esptool.py<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
</blockquote>
<p>そんな引数はないので、おかしいよなぁと思い再度ググると、esptool-ck という C で書かれたヘルパーツールがあるじゃありませんか？ esptool という名前は同じなので、てっきりpython のツールのことだと思っていました。</p>
<blockquote>
<p><a title="https://github.com/igrr/esptool-ck" href="https://github.com/igrr/esptool-ck" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/igrr/esptool-ck<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
</blockquote>
<p>あ、これですね、きっと。入れてみることに。</p>
<p>▼esptool-ck</p>
<p>・以下よりdownload </p>
<blockquote>
<p><a href="https://github.com/igrr/esptool-ck/releases" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/igrr/esptool-ck/releases<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
</blockquote>
<p>&#160;</p>
<p> osx なので、ボリュームをマウントしておきます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ sudo hdiutil mount ~/Documents/case-sensitive.dmg
$ cd /Volumes/case-sensitive</pre>
<p>バージョンは新しいのをまず試してみます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ wget https://github.com/igrr/esptool-ck/archive/0.4.6.tar.gz
$ tar xvfz 0.4.6.tar.gz 
$ mv esptool-ck-0.4.6/ esptool-ck
$ cd esptool-ck</pre>
<p>&#160;</p>
<p>gcc は入っているので、make し実行権限をつけます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$make
$ chmod +x esptool</pre>
<p>&#160;</p>
<p>・/opt/配下にシンボリックリンクを張っておきます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ sudo ln -s /Volumes/case-sensitive/esp-open-sdk/ /opt/Espressif</pre>
<p>・パスを反映</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ export PATH=/opt/Espressif/xtensa-lx106-elf/bin:/opt/Espressif/esptool-ck:$PATH
$ echo 'export PATH=/opt/Espressif/xtensa-lx106-elf/bin:/opt/Espressif/esptool-ck:$PATH' &gt;&gt; ~/.bashrc</pre>
<p>・呼び出せればOK</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ which esptool
/opt/Espressif/esptool-ck/esptool</pre>
<p>★espeink のソースディレクトリへ</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">sed -i 's/opt\/Espressif\/crosstool-NG\/builds\/xtensa-lx106-elf\/bin/opt\/Espressif\/xtensa-lx106-elf\/bin/g' Makefile
sed -i 's/\/opt\/Espressif\/ESP8266_SDK/\/opt\/Espressif\/sdk\//g' Makefile
sed -i 's/\/opt\/Espressif\/include/\/opt\/Espressif\/sdk\/include/g' Makefile
sed -i 's/\/opt\/Espressif\/arch\/lib/\/opt\/Espressif\/sdk\/lib/g' Makefile
sed -i 's/ttyUSB0/cu.SLAB_USBtoUART/g' Makefile</pre>
<p>&#160;</p>
<p>さて、make されてファームウェアもできるでしょうか？</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ make
CC user/cgiwifi.c
CC user/config.c
CC user/eink.c
CC user/espfs.c
CC user/heatshrink_decoder.c
CC user/httpd.c
CC user/httpdclient.c
CC user/httpdespfs.c
CC user/io.c
CC user/stdout.c
CC user/user_main.c
AR build/einkdisp_app.a
LD build/einkdisp.out
FW firmware/0x00000.bin
FW firmware/0x40000.bin</pre>
<p>&#160;</p>
<p>あっさり行けましたね。でも、サイズが小さいような気がします。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ ls -al build/ firmware/
build/:
total 1464
drwxr-xr-x   6 junkhack  staff     204  9 25 02:03 .
drwxr-xr-x  16 junkhack  staff     544  9 25 02:03 ..
drwxr-xr-x   2 junkhack  staff      68  9 25 02:03 driver
-rwxr-xr-x   1 junkhack  staff  514717  9 25 02:03 einkdisp.out
-rw-r--r--   1 junkhack  staff  231744  9 25 02:03 einkdisp_app.a
drwxr-xr-x  13 junkhack  staff     442  9 25 02:03 user

firmware/:
total 408
drwxr-xr-x   4 junkhack  staff     136  9 25 02:03 .
drwxr-xr-x  16 junkhack  staff     544  9 25 02:03 ..
-rw-r--r--   1 junkhack  staff   37632  9 25 02:03 0x00000.bin
-rw-r--r--   1 junkhack  staff  166264  9 25 02:03 0x40000.bin</pre>
<p>&#160;</p>
<p>500k くらいあるeinkdisp.out がファームに入っていないような気がします。ユーザ領域じゃないのでしょうかね。メモリマップはあまり見ていないので、これをどのように書き込めばいいかはまだ不明です。</p>
<p>&#160;</p>
<p>が、コンパイルはエラーなく通るようになりました。</p>
<p>SDK は、1.0.1 でとりあえずやっています。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ cd /opt/Espressif/
HOPE:Espressif junkhack$ ll
total 128
-rw-r--r--   1 junkhack  staff  11263  9 22 22:52 Makefile
-rw-r--r--   1 junkhack  staff   5725  9 22 22:52 README.md
-rw-r--r--   1 junkhack  staff   1101  9 22 22:52 c_types-c99.patch
drwxr-xr-x  18 junkhack  staff   1462  9 22 23:24 crosstool-NG
-rw-r--r--   1 junkhack  staff    199  9 22 22:52 crosstool-config-overrides
-rw-r--r--   1 junkhack  staff    146  9 22 22:52 empty_user_rf_pre_init.c
drwxr-xr-x@ 10 junkhack  staff    442  9 23 22:34 esp_iot_sdk_v0.9.5
drwxr-xr-x@ 10 junkhack  staff    374  4 24 17:08 esp_iot_sdk_v1.0.1
drwxr-xr-x@ 10 junkhack  staff    408  9 23 14:43 esp_iot_sdk_v1.1.1
drwxr-xr-x@ 10 junkhack  staff    374  6 12 20:49 esp_iot_sdk_v1.1.2
drwxr-xr-x  10 junkhack  staff    442  9 23 00:24 esp_iot_sdk_v1.3.0
drwxr-xr-x@ 10 junkhack  staff    374  9 18 21:55 esp_iot_sdk_v1.4.0
drwxr-xr-x   2 junkhack  staff    272  9 22 22:56 esptool
drwxr-xr-x   9 junkhack  staff    646  9 24 19:58 esptool-ck
drwxr-xr-x   9 junkhack  staff    510  9 24 19:44 esptool-ck_git
drwxr-xr-x   2 junkhack  staff    170  9 22 22:52 examples
drwxr-xr-x   6 junkhack  staff    612  9 23 00:25 lx106-hal
-rw-r--r--   1 junkhack  staff  24726  8  8 16:20 release_note.txt
lrwxr-xr-x   1 junkhack  staff     18  9 23 23:53 sdk -&gt; esp_iot_sdk_v1.0.1
drwxr-xr-x   8 junkhack  staff    306  9 23 00:21 xtensa-lx106-elf</pre>
<p>&#160;</p>
<p>Makefile には、以下のオプションも指定されているので、書き込みできるはずです。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">::
flash: $(FW_FILE_1) $(FW_FILE_2)
    $(Q) $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x00000 -cf firmware/0x00000.bin -v
    $(Q) [ $(ESPDELAY) -ne 0 ] &amp;&amp; echo &quot;Please put the ESP in bootloader mode...&quot; || true
    $(Q) sleep $(ESPDELAY) || true
    $(Q) $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x40000 -cf firmware/0x40000.bin -v

::


webpages.espfs: html/ mkespfsimage/mkespfsimage
    cd html; find | ../mkespfsimage/mkespfsimage &gt; ../webpages.espfs; cd ..

mkespfsimage/mkespfsimage: mkespfsimage/
    make -C mkespfsimage

htmlflash: webpages.espfs
    if [ $$(stat -c '%s' webpages.espfs) -gt $$(( 0x2E000 )) ]; then echo &quot;webpages.espfs too big!&quot;; false; fi
    $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x12000 -cf webpages.espfs -v
::</pre>
<p>土日にesp に書き込んでみることにします。</p>
<p>&#160;</p>
<p>esp12 をつなげていないと、以下のようになりました。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">HOPE:espeink junkhack$ make webpages.espfs
cd html; find | ../mkespfsimage/mkespfsimage &gt; ../webpages.espfs; cd ..
/bin/sh: ../mkespfsimage/mkespfsimage: cannot execute binary file
usage: find [-H | -L | -P] [-EXdsx] [-f path] path ... [expression]
       find [-H | -L | -P] [-EXdsx] -f path [path ...] [expression]
HOPE:espeink junkhack$ 

HOPE:espeink junkhack$ make mkespfsimage/mkespfsimage
make: `mkespfsimage/mkespfsimage' is up to date.
HOPE:espeink junkhack$ 

HOPE:espeink junkhack$ make htmlflash
if [ $(stat -c '%s' webpages.espfs) -gt $(( 0x2E000 )) ]; then echo &quot;webpages.espfs too big!&quot;; false; fi
stat: illegal option -- c
usage: stat [-FlLnqrsx] [-f format] [-t timefmt] [file ...]
/bin/sh: line 0: [: -gt: unary operator expected
esptool -cp /dev/cu.SLAB_USBtoUART -cb 115200 -ca 0x12000 -cf webpages.espfs -v
esptool vb64eebd - (c) 2014 Ch. Klippel &lt;ck@atelier-klippel.de&gt;
opening port /dev/cu.SLAB_USBtoUART at 115200
opening bootloader
resetting board
trying to connect
trying to connect
trying to connect
resetting board
trying to connect
trying to connect
trying to connect
resetting board
trying to connect
trying to connect
trying to connect
warning: espcomm_sync failed
error: espcomm_open failed
make: *** [htmlflash] Error 255
HOPE:espeink junkhack$ 

HOPE:espeink junkhack$ make flash
esptool vb64eebd - (c) 2014 Ch. Klippel &lt;ck@atelier-klippel.de&gt;
opening port /dev/cu.SLAB_USBtoUART at 115200
opening bootloader
resetting board
trying to connect
trying to connect
trying to connect
resetting board
trying to connect
trying to connect
trying to connect
resetting board
trying to connect
trying to connect
trying to connect
warning: espcomm_sync failed
error: espcomm_open failed
make: *** [flash] Error 255
HOPE:espeink junkhack$ </pre>
<p>▼まとめ</p>
<p>・esptool は python のじゃなくて、C 製の esptool-ck というのを使う</p>
<p>・esptool-ck にはいろいろなオプションがあるようです。</p>
<p>・配線を以下のようにして、resetmethod=wifio などとすれば、UART の RTS and DTRを使ってブートモードにしたりできるようです。</p>
<p> <a title="https://github.com/esp8266/Arduino/issues/22" href="https://github.com/esp8266/Arduino/issues/22" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/esp8266/Arduino/issues/22<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>・できた２つのファームはサイズが小さいようだが？</p>
<p>・make のオプションに書き込みや、その他の何か作業するものがある</p>
					</div>
<!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div>
<!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-1256" class="post-1256 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-sdk">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="/2015/09/24/espeink-make2/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-09-24T02:19:22+09:00">2015年9月24日</time></a> </span><span class="posted-on">更新日:2015年9月24日</span> <span class="categories">  <a href="/category/esp8266/" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="/category/espeink/" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="/category/sdk/" rel="category tag noopener noreferrer" data-wpel-link="internal">sdk</a></span>			</div>
<!-- .entry-meta -->

							<h1 class="entry-title"><a href="/2015/09/24/espeink-make2/" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink make その2</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>作者にヘルプ要請を出しておきました。作者からレスポンスがあるまで、自分なりにもう少し調べみます。</p>
<p>その後、再調査でSDK 1.3.0を使うと、   <br>unknown type name &#8216;uint16_t&#8217;    <br>が出るようです。以下に情報が。</p>
<blockquote>
<p><a href="https://github.com/pfalcon/esp-open-sdk/issues/90" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/pfalcon/esp-open-sdk/issues/90<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>これは、再度指定すれば回避できそうです。     <br>#include &lt;stdint.h&gt;</p>
</blockquote>
<p>まぁ、でもこんなことは作者はやっていないわけで、ということは、もっと古いsdkでやっているということだと思うので代えてみます。esp_iot_sdk_v1.1.1 で とりあえずチャレンジ。</p>
<blockquote>
<p>$ rm sdk     <br>$ ln -s esp_iot_sdk_v1.1.1 sdk </p>
</blockquote>
<p>・unknown type name は出なくなるが、conflicting types が出る。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">    $ make
    CC user/cgiwifi.c
    In file included from user/cgiwifi.c:20:0:
    include/espmissingincludes.h:42:5: error: conflicting types for 'os_random'
     int os_random();
         ^
    In file included from user/cgiwifi.c:15:0:
    /Volumes/case-sensitive/esp-open-sdk/sdk/include/osapi.h:45:15: note: previous declaration of 'os_random' was here
     unsigned long os_random(void);
                   ^
    make: *** [build/user/cgiwifi.o] Error 1</pre>
<p>&#160;</p>
<p>・ちょっと状況は違うかもですが、以下に情報が。</p>
<blockquote>
<p>
    <br><a href="http://www.esp8266.com/viewtopic.php?p=18868" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.esp8266.com/viewtopic.php?p=18868<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>おそらく作者からのコメントで、include/espmissingincludes.h のos_randomを取ってしまえば？と。<br>
    <br>はい、とりました。</p>
</blockquote>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- espmissingincludes.h
::
uint32 system_get_time();
//int os_random();
int rand(void);
::</pre>
<p>&#160;</p>
<p>・すると、user/cgiwifi.c は通り、次なるエラーが。プロトタイプ宣言がないようです。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">    $ make
    CC user/cgiwifi.c
    CC user/config.c
    CC user/eink.c
    user/eink.c: In function 'einkTimerCb':
    user/eink.c:60:3: error: implicit declaration of function 'os_update_cpu_frequency' [-Werror=implicit-function-declaration]
       os_update_cpu_frequency(160);
       ^
    cc1: all warnings being treated as errors
    make: *** [build/user/eink.o] Error 1</pre>
<p>&#160;</p>
<p>&#160;</p>
<p>einkTimerCb関数の中から呼ばれているようです。<br>
  <br>こいつは、ソース全体をgrep しても出ないので、sdk の組み込み関数のようです。なんと宣言すればよいのでしょうかね？ </p>
<p>以下のリリースノートによると、esp_iot_sdk_v1.1.0_15_05_26 でなくなったようです！<br>
  <br><a href="http://www.esp8266.com/viewtopic.php?p=18496" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.esp8266.com/viewtopic.php?p=18496<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>その前の、esp_iot_sdk_v1.0.1/include/osapi.h にはあるようです。</p>
<p>ということは、作者はesp_iot_sdk_v1.0.1より前のSDK を使っていたということですね。 </p>
<p>ソース修正はとりあえず、後回しで、今は作者の環境を推測し、最後までコンパイルが通る環境を探るのが優先です。 </p>
<p><a href="http://bbs.espressif.com/viewforum.php?f=46" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://bbs.espressif.com/viewforum.php?f=46<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>の一覧から、esp_iot_sdk_v1.0.1_15_04_24 がありました。</p>
<p>リリース日は、Fri Apr 24, 2015 10:49 pm です。</p>
<p><a href="http://bbs.espressif.com/viewtopic.php?f=46&amp;t=398" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://bbs.espressif.com/viewtopic.php?f=46&amp;t=398<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<blockquote>
<p>ダウンロードし、解凍してシンボリックリンクを張り直します。<br>
    <br>$ rm sdk</p>
<p>$ ln -s esp_iot_sdk_v1.0.1 sdk</p>
</blockquote>
<p>・再度make</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ make clean
$ make
CC user/cgiwifi.c
CC user/config.c
CC user/eink.c
CC user/espfs.c
CC user/heatshrink_decoder.c
CC user/httpd.c
CC user/httpdclient.c
CC user/httpdespfs.c
CC user/io.c
CC user/stdout.c
CC user/user_main.c
AR build/einkdisp_app.a
LD build/einkdisp.out
FW firmware/0x00000.bin
make: esptool: No such file or directory
make: *** [firmware/0x00000.bin] Error 1</pre>
<p>&#160;</p>
<p>・おおお、make は通ったようです。esptool がないとか言っていますね。</p>
<blockquote>
<p>$ which esptool.py<br>
    <br>/usr/local/bin/esptool.py </p>
</blockquote>
<p>・あるので、以下のように指定し直します。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- Makefile
::
#Esptool.py path and port
ESPTOOL        ?= /usr/local/bin/esptool.py
::</pre>
<p>・さて、再度挑戦。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ make clean
$ make
CC user/cgiwifi.c
CC user/config.c
CC user/eink.c
CC user/espfs.c
CC user/heatshrink_decoder.c
CC user/httpd.c
CC user/httpdclient.c
CC user/httpdespfs.c
CC user/io.c
CC user/stdout.c
CC user/user_main.c
AR build/einkdisp_app.a
LD build/einkdisp.out
FW firmware/0x00000.bin
usage: esptool [-h] [--port PORT] [--baud BAUD]
               
               {load_ram,dump_mem,read_mem,write_mem,write_flash,run,image_info,make_image,elf2image,read_mac,flash_id,read_flash,erase_flash}
               ...
esptool: error: argument operation: invalid choice: 'build/einkdisp.out' (choose from 'load_ram', 'dump_mem', 'read_mem', 'write_mem', 'write_flash', 'run', 'image_info', 'make_image', 'elf2image', 'read_mac', 'flash_id', 'read_flash', 'erase_flash')
make: *** [firmware/0x00000.bin] Error 2</pre>
<p>&#160;</p>
<p>・ううむ、esptool の使い方が違うよと出ているようです。<br>
  <br> makefile には次のように書かれています。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- Makefile
::
$(FW_FILE_1): $(TARGET_OUT) firmware
    $(vecho) &quot;FW $@&quot;
    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_1_ARGS)
::</pre>
<p>&#160;</p>
<p>使い方は、以下のようです。<br>
  <br>-eo とかなんでしょうね？ 説明にありませんが、、、</p>
<p>&#160;</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">    $ esptool.py -h
    usage: esptool [-h] [--port PORT] [--baud BAUD]
                   
                   {load_ram,dump_mem,read_mem,write_mem,write_flash,run,image_info,make_image,elf2image,read_mac,flash_id,read_flash,erase_flash}
                   ...
    
    ESP8266 ROM Bootloader Utility
    
    positional arguments:
      {load_ram,dump_mem,read_mem,write_mem,write_flash,run,image_info,make_image,elf2image,read_mac,flash_id,read_flash,erase_flash}
                            Run esptool {command} -h for additional help
        load_ram            Download an image to RAM and execute
        dump_mem            Dump arbitrary memory to disk
        read_mem            Read arbitrary memory location
        write_mem           Read-modify-write to arbitrary memory location
        write_flash         Write a binary blob to flash
        run                 Run application code in flash
        image_info          Dump headers from an application image
        make_image          Create an application image from binary files
        elf2image           Create an application image from ELF file
        read_mac            Read MAC address from OTP ROM
        flash_id            Read SPI flash manufacturer and device ID
        read_flash          Read SPI flash content
        erase_flash         Perform Chip Erase on SPI flash
    
    optional arguments:
      -h, --help            show this help message and exit
      --port PORT, -p PORT  Serial port device
      --baud BAUD, -b BAUD  Serial port baud rate</pre>
<p>&#160;</p>
<p>・変数には以下が入っているので、★は以下のようです。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">/usr/local/bin/esptool.py -eo build/einkdisp.out -bo $@ -bs .text -bs .data -bs .rodata -bc -ec</pre>
<p>&#160;</p>
<p>うーん、よくわかりませんね。まぁ、とにかくesptool.pyの使い方ということを調査すれば解決するかもです。<br>
  <br>esptool.pyっていうのは、アップロードするだけのものと思っていましたが、他にも用途があるということですかね。</p>
<p>&#160;</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- Makefile
::
BUILD_BASE    = build
::
ESPTOOL        ?= /usr/local/bin/esptool.py
::
# name for the target project
TARGET        = einkdisp
::
TARGET_OUT    := $(addprefix $(BUILD_BASE)/,$(TARGET).out)
::
# we create two different files for uploading into the flash
# these are the names and options to generate them
FW_FILE_1    = 0x00000
FW_FILE_1_ARGS    = -bo $@ -bs .text -bs .data -bs .rodata -bc -ec
FW_FILE_2    = 0x40000
FW_FILE_2_ARGS    = -es .irom0.text $@ -ec
::
$(FW_FILE_1): $(TARGET_OUT) firmware
    $(vecho) &quot;FW $@&quot;
    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_1_ARGS)★
::</pre>
<p>&#160;</p>
<p>・以下な感じにしてみると、作られますが、ファイルサイズが小さいので、やっぱりだめかな？</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- Makefile
::
$(FW_BASE)/%.bin: $(TARGET_OUT) | $(FW_BASE)
    $(vecho) &quot;FW $(FW_BASE)/&quot;
    $(Q) $(ESPTOOL) elf2image -o $(FW_BASE)/ $(TARGET_OUT)
#    $(Q) $(ESPTOOL) -o $(TARGET_OUT) $(FW_FILE_1_ARGS)

$(FW_FILE_2): $(TARGET_OUT) firmware
    $(vecho) &quot;FW $(FW_BASE)/&quot;
    $(Q) $(ESPTOOL) -o $(TARGET_OUT) $(FW_FILE_2_ARGS)
::</pre>
<p>&#160;</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ make
CC user/cgiwifi.c
CC user/config.c
CC user/eink.c
CC user/espfs.c
CC user/heatshrink_decoder.c
CC user/httpd.c
CC user/httpdclient.c
CC user/httpdespfs.c
CC user/io.c
CC user/stdout.c
CC user/user_main.c
AR build/einkdisp_app.a
LD build/einkdisp.out
FW firmware/

$ ls -ltr firmware/ build/
firmware/:
total 408
-rw-r--r--  1 junkhack  staff  166264  9 24 02:00 0x40000.bin
-rw-r--r--  1 junkhack  staff   37632  9 24 02:00 0x00000.bin

build/:
total 1464
drwxr-xr-x   2 junkhack  staff      68  9 23 02:05 driver
drwxr-xr-x  13 junkhack  staff     442  9 24 02:00 user
-rw-r--r--   1 junkhack  staff  231984  9 24 02:00 einkdisp_app.a
-rwxr-xr-x   1 junkhack  staff  514957  9 24 02:00 einkdisp.out</pre>
<p>&#160;</p>
<p>このあたりを読んでみますか。<br>
  <br><a href="https://github.com/themadinventor/esptool" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/themadinventor/esptool<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>とりあえず、本日はここまで。</p>
<p>▼まとめ</p>
<p>・sdk は、esp_iot_sdk_v1.0.1より前のを使っていたようです。</p>
<p>・esp_iot_sdk_v1.0.1_15_04_24 でコンパイルエラーはなくなった</p>
<p>・esptool.py でファームウェアを作るところがうまくいかない</p>
<p>・linux 版のesptool.py とかだと、あのオプション指定が通るのか？</p>
<p>・実行ファイルeinkdisp.outは、作成できている模様</p>
<p>・ファームウェアのどの領域にどうやって作成するのかを調査すればよさそう</p>
					</div>
<!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div>
<!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-1252" class="post-1252 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-sdk">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="/2015/09/23/espeink-make/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-09-23T20:13:18+09:00">2015年9月23日</time></a> </span><span class="posted-on">更新日:2015年9月23日</span> <span class="categories">  <a href="/category/esp8266/" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="/category/espeink/" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="/category/sdk/" rel="category tag noopener noreferrer" data-wpel-link="internal">sdk</a></span>			</div>
<!-- .entry-meta -->

							<h1 class="entry-title"><a href="/2015/09/23/espeink-make/" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink のソースをコンパイル</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>さて、ハードの調査が終わったので、今度はソースファイルの調査です。</p>
<p>まず、ざっとソースコードを見てみます。</p>
<p>osx 10.9.5 でやっています。</p>
<blockquote>
<p>▼ソースをゲット     <br>$ git clone <a href="http://git.spritesserver.nl/espeink.git/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://git.spritesserver.nl/espeink.git/<span class="wpel-icon wpel-image wpel-icon-1"></span></a>      <br>$ cd espeink/      <br>$ git submodule init      <br>$ git submodule update</p>
</blockquote>
<p>以下のことがわかりました。</p>
<p>▼ソフトウェア概略   <br>・ESP12 の中で動作するwebサーバがmkespfsimageを使いe-ink にレンダリング    <br>・データ受け渡しは、PhantomJS（pixelserver.js）を使っているよう    <br>・画像形式は、.bm という白黒２値（グレー表示はあるのかな？）800&#215;600を使用    <br>・デフォルトで60秒ごとにsleep から目覚めるよう -&gt; sleeptime , system_deep_sleep(60*1000*1000);    <br>・初回起動時は、アクセスポイントの表示の初期設定が動作。メモリの特定領域に値があるかないかを見ている模様 -&gt; RTC_MAGIC    <br>・ライセンスは、Beer-Ware license 🙂    <br><a href="https://en.wikipedia.org/wiki/Beerware" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://en.wikipedia.org/wiki/Beerware<span class="wpel-icon wpel-image wpel-icon-1"></span></a>    <br>&#160; これは作者のジョークかと。GPLライブラリーにリンクしているのでこのソースもGPLになりますが、    <br>&#160; 何か作者に送りたいですよね。    <br>・圧縮ライブラリに、Heatshrink使用    <br><a href="https://github.com/atomicobject/heatshrink" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/atomicobject/heatshrink<span class="wpel-icon wpel-image wpel-icon-1"></span></a>    <br>&#160; Lempel–Ziv–Storer–Szymanski (LZSS)ベースのようです。    <br>・ソースをビルドするには、SDK (toolchain) が必要    <br>・esp-open-sdkの環境を作れば良いかと思う    <br>・環境構築は、osx でまずチャレンジ</p>
<p>&#160;</p>
<p>PhantomJSって何でしょうか？</p>
<p>とりあえず、まぁ、使ってみれば理解も深まるはずです。</p>
<p>osx のローカルに入れてみます。</p>
<blockquote>
<p>$ brew install phantomjs</p>
</blockquote>
<p>サンプルはググって以下のようにしました。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- test.js
// Headless ブラウザの生成
var page = require('webpage').create();

// URL を開く
page.open('http://hack.gpl.jp/about/', function(status) {
    if (status === 'success') {
        // スクリーンキャプチャ
        page.render('junkhack.png');
        // ブラウザ内で JS を実行してデータを受け取る
        var title = page.evaluate(function() {
            var title = document.title;
            return title;
        });
        console.log(title);
    }
    // exit しないと終了しない
    phantom.exit();
});</pre>
<p>&#160;</p>
<p>・実行してみます。</p>
<blockquote>
<p>$ phantomjs test.js</p>
</blockquote>
<p>カレントディレクトリに、junkhack.png ができている。ほーなるほど。<br>
  <br>ということは、PhantomJSが動作するサーバが必要だってことでしょうかね？ESP12 でPhantomJSが動作するということですかね？ちょっとこのあたりは良くわかっていません。</p>
<p>その内、進むにつれ解るはずだと思うので、スルーします。</p>
<p>&#160;</p>
<p><img loading="lazy" decoding="async" title="junkhack 2" style="border-top:0;border-right:0;border-bottom:0;float:none;margin-left:auto;border-left:0;display:block;margin-right:auto;" border="0" alt="junkhack 2" src="/wp-content/uploads/2015/09/junkhack2.png" width="400" height="1096"> </p>
<p>とりあえず、osx でビルドする環境を整えてみることにしてみます。</p>
<p>&#160;</p>
<p>▼ビルドする環境の構築 for osx 10.9.5 </p>
<p>・以下にある説明通り </p>
<p><a href="https://github.com/pfalcon/esp-open-sdk" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/pfalcon/esp-open-sdk<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<blockquote>
<p>$ brew tap homebrew/dupes<br>
    <br>$ brew install binutils coreutils automake wget gawk libtool gperf gnu-sed &#8211;with-default-names grep</p>
</blockquote>
<p>★ちょっと時間はかかります。エラーになっていないかコンソールを確認。</p>
<p>&#160;</p>
<p>・sed は gnu のを使うようにするようです。以下のようにならなければ、パスを.bash_profileに設定しておきます。 </p>
<p>&#160;&#160;&#160; $ which sed<br>
  <br>&#160;&#160;&#160; /usr/local/opt/gnu-sed/libexec/gnubin/sed </p>
<p>$ export PATH=&quot;/usr/local/opt/gnu-sed/libexec/gnubin:$PATH&quot;</p>
<p>&#160;</p>
<p>・10G の大文字小文字ファイル名を区別するHFS+ボリュームを作製。マウントし、移動。 </p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ sudo hdiutil create ~/Documents/case-sensitive.dmg -volname &quot;case-sensitive&quot; -size 10g -fs &quot;Case-sensitive HFS+&quot;
$ sudo hdiutil mount ~/Documents/case-sensitive.dmg
$ cd /Volumes/case-sensitive

$ git clone --recursive https://github.com/pfalcon/esp-open-sdk.git</pre>
<p>スタンドアローンなSDK を作れば、-Iと-Lフラグを付けなくてよいようですが、espeink のmakefile は<br>
  <br>-I と -L は指定されているので、SDK を分離して作ります。 </p>
<blockquote>
<p>$ cd esp-open-sdk/<br>
    <br>$ make STANDALONE=n</p>
</blockquote>
<p>★ちょっと時間はかかります。コーヒータイムです。<br>
  <br>ESP8266 のチップは、ケイデンス・デザイン・システムズ社が作っているXtensaプロセッサなんですね。</p>
<p>Espressif Systems社がカスタマイズした、テンシリカXtensaプロセッサが載っているということの</p>
<p>ようです。</p>
<p>https://www.cadence.co.jp/news/2015-01-29-929.html</p>
<p>&#160;</p>
<p>・さて、以下のようになっていればOKです。パスを追加します。 </p>
<p>&#160;&#160;&#160; ::<br>
  <br>&#160;&#160;&#160; Xtensa toolchain is built, to use it:</p>
<p>&#160;&#160;&#160; export PATH=/Volumes/case-sensitive/esp-open-sdk/xtensa-lx106-elf/bin:$PATH</p>
<p>&#160;&#160;&#160; Espressif ESP8266 SDK is installed. Toolchain contains only Open Source components</p>
<p>&#160;&#160;&#160; To link external proprietary libraries add:</p>
<p>&#160;&#160;&#160; xtensa-lx106-elf-gcc -I/Volumes/case-sensitive/esp-open-sdk/sdk/include -L/Volumes/case-sensitive/esp-open-sdk/sdk/lib</p>
<p>&#160;</p>
<p>・ここもパスを通しておきます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">---- .bashrc　追記
export PATH=/Volumes/case-sensitive/esp-open-sdk/xtensa-lx106-elf/bin:$PATH</pre>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">以下に、コンパイラがあります。</pre>
<blockquote>
<p>$ ls /Volumes/case-sensitive/esp-open-sdk/xtensa-lx106-elf/bin<br>
    <br>esptool.py&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-ct-ng.config&#160;&#160;&#160; xtensa-lx106-elf-gcov&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-ranlib</p>
<p>xtensa-lx106-elf-addr2line&#160;&#160;&#160; xtensa-lx106-elf-elfedit&#160;&#160;&#160; xtensa-lx106-elf-gdb&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-readelf</p>
<p>xtensa-lx106-elf-ar&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-g++&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-gprof&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-size</p>
<p>xtensa-lx106-elf-as&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-gcc&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-ld&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-strings</p>
<p>xtensa-lx106-elf-c++&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-gcc-4.8.2&#160;&#160;&#160; xtensa-lx106-elf-ld.bfd&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-strip</p>
<p>xtensa-lx106-elf-c++filt&#160;&#160;&#160; xtensa-lx106-elf-gcc-ar&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-nm</p>
<p>xtensa-lx106-elf-cc&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-gcc-nm&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-objcopy</p>
<p>xtensa-lx106-elf-cpp&#160;&#160;&#160;&#160;&#160;&#160;&#160; xtensa-lx106-elf-gcc-ranlib&#160;&#160;&#160; xtensa-lx106-elf-objdump </p>
</blockquote>
<p>&#160;</p>
<p>・コンパイラが呼び出せればOKです。 </p>
<blockquote>
<p>$ which xtensa-lx106-elf-gcc<br>
    <br>/Volumes/case-sensitive/esp-open-sdk/xtensa-lx106-elf/bin/xtensa-lx106-elf-gcc</p>
</blockquote>
<blockquote>
<p>$ xtensa-lx106-elf-gcc &#8211;version<br>
    <br>xtensa-lx106-elf-gcc (crosstool-NG 1.20.0) 4.8.2</p>
<p>Copyright (C) 2013 Free Software Foundation, Inc.</p>
<p>This is free software; see the source for copying conditions.&#160; There is NO</p>
<p>warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. </p>
</blockquote>
<p>・何かコンパイルして動作確認してみましょう。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ git clone https://github.com/esp8266/source-code-examples.git
$ cd source-code-examples/blinky</pre>
<p>&#160;</p>
<p>・sed で make ファイルの指定を書き換えます。<br>
  <br> ※パスがあるので、解りにくい。sed は s/置き換え前/置き換え後/g です。 </p>
<p>以下だと、<br>
  <br> Espressif/crosstool-NG/builds/xtensa-lx106-elf/bin</p>
<p> を以下に置き換え</p>
<p> esp-open-sdk/xtensa-lx106-elf/bin </p>
<p>&#160; Espressif/ESP8266_SDK<br>
  <br>&#160; を以下に置き換え</p>
<p>&#160; esp-open-sdk/sdk </p>
<p>&#160; Espressif<br>
  <br>&#160; を以下に置き換え</p>
<p>&#160; esp-open-sdk </p>
<p>&#160; opt/<br>
  <br>&#160; を以下に置き換え</p>
<p>&#160; Volumes/case-sensitive/</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ sed -i 's/Espressif\/crosstool-NG\/builds\/xtensa-lx106-elf\/bin/esp-open-sdk\/xtensa-lx106-elf\/bin/g' Makefile
$ sed -i 's/Espressif\/ESP8266_SDK/esp-open-sdk\/sdk/g' Makefile
$ sed -i 's/Espressif/esp-open-sdk/g' Makefile
$ sed -i 's/opt\//Volumes\/case-sensitive\//g' Makefile</pre>
<p>&#160;</p>
<p>make してみます。</p>
<p>$ make </p>
<p>・以下が実行結果です。エラーなくビルドできればまぁ、動くでしょう。</p>
<blockquote>
<p>$ tree<br>
    <br>.</p>
<p>├── Makefile</p>
<p>├── README</p>
<p>├── build</p>
<p>│&#160;&#160; ├── app.out★実行バイナリファイル</p>
<p>│&#160;&#160; ├── app_app.a</p>
<p>│&#160;&#160; ├── driver</p>
<p>│&#160;&#160; └── user</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; └── user_main.o</p>
<p>├── firmware</p>
<p>│&#160;&#160; ├── 0x00000.bin★</p>
<p>│&#160;&#160; └── 0x40000.bin★</p>
<p>└── user</p>
<p>&#160;&#160;&#160; ├── user_config.h</p>
<p>&#160;&#160;&#160; └── user_main.c </p>
<p>5 directories, 9 files</p>
</blockquote>
<p>&#160;</p>
<p>▼とりあえず、esp-open-sdk でコンパイルしてみます。Makefile のコピーを取ってパスを書き換え。 </p>
<blockquote>
<p>$ cd espeinkのソース<br>
    <br>$ cp Makefile Makefile_org </p>
</blockquote>
<p>※行頭の$ は取ってあります。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">sed -i 's/Espressif\/crosstool-NG\/builds\/xtensa-lx106-elf\/bin/esp-open-sdk\/xtensa-lx106-elf\/bin/g' Makefile
sed -i 's/Espressif\/ESP8266_SDK/esp-open-sdk\/sdk/g' Makefile
sed -i 's/Espressif/esp-open-sdk/g' Makefile
sed -i 's/opt\/Espressif\/arch\/lib/Volumes\/case-sensitive\/esp-open-sdk\/sdk\/lib/g' Makefile
sed -i 's/opt\//Volumes\/case-sensitive\//g' Makefile</pre>
<p>・osx じゃなく、Linux でやっている場合はほどよく書き換え。以下のようにパスを変更しました。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ diff Makefile Makefile_org 
15c15
&lt; XTENSA_TOOLS_ROOT ?= /Volumes/case-sensitive/esp-open-sdk/xtensa-lx106-elf/bin
---
&gt; XTENSA_TOOLS_ROOT ?= /opt/Espressif/crosstool-NG/builds/xtensa-lx106-elf/bin
18,19c18,19
&lt; SDK_EXTRA_INCLUDES ?= /Volumes/case-sensitive/esp-open-sdk/include
&lt; SDK_EXTRA_LIBS ?= /Volumes/case-sensitive/esp-open-sdk/sdk/lib
---
&gt; SDK_EXTRA_INCLUDES ?= /opt/Espressif/include
&gt; SDK_EXTRA_LIBS ?= /opt/Espressif/arch/lib
22c22
&lt; SDK_BASE    ?= /Volumes/case-sensitive/esp-open-sdk/sdk
---
&gt; SDK_BASE    ?= /opt/Espressif/ESP8266_SDK</pre>
<p>&#160;</p>
<p>・さて、makeしてみます。</p>
<p>make しましたが、なんかエラーでますね。作者は、SDK バージョンいくつを使っていたのでしょうか？</p>
<p>unknown type name &#8216;uint32_t&#8217;<br>
  <br>unknown type name &#8216;uint8_t&#8217;</p>
<p>unknown type name &#8216;uint16_t&#8217;</p>
<p>conflicting types for &#8216;os_random&#8217; </p>
<p>&#160;&#160;&#160; $ make<br>
  <br>&#160;&#160;&#160; CC user/cgiwifi.c</p>
<p>&#160;&#160;&#160; In file included from /Volumes/case-sensitive/esp-open-sdk/sdk/include/os_type.h:10:0,</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; from /Volumes/case-sensitive/esp-open-sdk/sdk/include/user_interface.h:9,</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; from user/cgiwifi.c:17:</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/ets_sys.h:14:1: error: unknown type name &#8216;uint32_t&#8217;</p>
<p>&#160;&#160;&#160;&#160; typedef uint32_t ETSSignal;</p>
<p>&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/ets_sys.h:15:1: error: unknown type name &#8216;uint32_t&#8217;</p>
<p>&#160;&#160;&#160;&#160; typedef uint32_t ETSParam;</p>
<p>&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/ets_sys.h:27:1: error: unknown type name &#8216;uint32_t&#8217;</p>
<p>&#160;&#160;&#160;&#160; typedef uint32_t ETSHandle;</p>
<p>&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/ets_sys.h:32:5: error: unknown type name &#8216;uint32_t&#8217;</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; uint32_t&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; timer_expire;</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/ets_sys.h:33:5: error: unknown type name &#8216;uint32_t&#8217;</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; uint32_t&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; timer_period;</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; In file included from user/cgiwifi.c:17:0:</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/user_interface.h:316:1: error: unknown type name &#8216;uint8_t&#8217;</p>
<p>&#160;&#160;&#160;&#160; void wifi_promiscuous_set_mac(const uint8_t *address);</p>
<p>&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; In file included from user/cgiwifi.c:20:0:</p>
<p>&#160;&#160;&#160; user/io.h:3:16: error: unknown type name &#8216;uint16_t&#8217;</p>
<p>&#160;&#160;&#160;&#160; void ioSpiSend(uint16_t data);</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; user/io.h:8:18: error: unknown type name &#8216;uint8_t&#8217;</p>
<p>&#160;&#160;&#160;&#160; void ioEinkWrite(uint8_t data);</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; In file included from user/cgiwifi.c:21:0:</p>
<p>&#160;&#160;&#160; include/espmissingincludes.h:42:5: error: conflicting types for &#8216;os_random&#8217;</p>
<p>&#160;&#160;&#160;&#160; int os_random();</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; In file included from user/cgiwifi.c:16:0:</p>
<p>&#160;&#160;&#160; /Volumes/case-sensitive/esp-open-sdk/sdk/include/osapi.h:45:15: note: previous declaration of &#8216;os_random&#8217; was here</p>
<p>&#160;&#160;&#160;&#160; unsigned long os_random(void);</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^</p>
<p>&#160;&#160;&#160; make: *** [build/user/cgiwifi.o] Error 1</p>
<p>&#160;</p>
<p>▼sdk をいろいろ代えて試し、0.9.5あたりから試しました。</p>
<blockquote>
<p>$ cd /Volumes/case-sensitive/esp-open-sdk/<br>
    <br>$ ln -s esp_iot_sdk_v0.9.5 sdk</p>
</blockquote>
<p>▼バイナリはできるけども、ファームウェアができないので、Makefile を書き換え。<br>
  <br> ※ まだ実機で試していないので、これで良いか不明ですが。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ cat Makefile.patch 
--- Makefile_org    2015-09-11 00:13:00.000000000 +0900
+++ Makefile    2015-09-23 15:29:56.000000000 +0900
@@ -12,18 +12,18 @@ BUILD_BASE    = build
 FW_BASE        = firmware
 
 # Base directory for the compiler
-XTENSA_TOOLS_ROOT ?= /opt/Espressif/crosstool-NG/builds/xtensa-lx106-elf/bin
+XTENSA_TOOLS_ROOT ?= /Volumes/case-sensitive/esp-open-sdk/xtensa-lx106-elf/bin
 
 #Extra Tensilica includes from the ESS VM
-SDK_EXTRA_INCLUDES ?= /opt/Espressif/include
-SDK_EXTRA_LIBS ?= /opt/Espressif/arch/lib
+SDK_EXTRA_INCLUDES ?= /Volumes/case-sensitive/esp-open-sdk/include
+SDK_EXTRA_LIBS ?= /Volumes/case-sensitive/esp-open-sdk/sdk/lib
 
 # base directory of the ESP8266 SDK package, absolute
-SDK_BASE    ?= /opt/Espressif/ESP8266_SDK
+SDK_BASE    ?= /Volumes/case-sensitive/esp-open-sdk/sdk
 
 #Esptool.py path and port
-ESPTOOL        ?= esptool
-ESPPORT        ?= /dev/ttyUSB0
+ESPTOOL        ?= esptool.py
+ESPPORT        ?= /dev/tty.SLAB_USBtoUART
 #ESPDELAY indicates seconds to wait between flashing the two binary images
 ESPDELAY    ?= 3
 ESPBAUD        ?= 115200
@@ -61,9 +61,9 @@ SDK_INCDIR    = include include/json
 # we create two different files for uploading into the flash
 # these are the names and options to generate them
 FW_FILE_1    = 0x00000
-FW_FILE_1_ARGS    = -bo $@ -bs .text -bs .data -bs .rodata -bc -ec
+#FW_FILE_1_ARGS    = -bo $@ -bs .text -bs .data -bs .rodata -bc -ec
 FW_FILE_2    = 0x40000
-FW_FILE_2_ARGS    = -es .irom0.text $@ -ec
+#FW_FILE_2_ARGS    = -es .irom0.text $@ -ec
 
 # select which tools to use as compiler, librarian and linker
 CC        := $(XTENSA_TOOLS_ROOT)/xtensa-lx106-elf-gcc
@@ -117,13 +117,17 @@ endef
 
 all: checkdirs $(TARGET_OUT) $(FW_FILE_1) $(FW_FILE_2)
 
-$(FW_FILE_1): $(TARGET_OUT) firmware
-    $(vecho) &quot;FW $@&quot;
-    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_1_ARGS)
-
-$(FW_FILE_2): $(TARGET_OUT) firmware
-    $(vecho) &quot;FW $@&quot;
-    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_2_ARGS)
+$(FW_BASE)/%.bin: $(TARGET_OUT) | $(FW_BASE)
+    $(vecho) &quot;FW $(FW_BASE)/&quot;
+    $(Q) $(ESPTOOL) elf2image -o $(FW_BASE)/ $(TARGET_OUT)
+    
+#$(FW_FILE_1): $(TARGET_OUT) firmware
+#    $(vecho) &quot;FW $@&quot;
+#    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_1_ARGS)
+
+#$(FW_FILE_2): $(TARGET_OUT) firmware
+#    $(vecho) &quot;FW $@&quot;
+#    $(Q) $(ESPTOOL) -eo $(TARGET_OUT) $(FW_FILE_2_ARGS)
 
 $(TARGET_OUT): $(APP_AR)
     $(vecho) &quot;LD $@&quot;
@@ -138,14 +142,20 @@ checkdirs: $(BUILD_DIR) $(FW_BASE)
 $(BUILD_DIR):
     $(Q) mkdir -p $@
 
-firmware:
+#firmware:
+#    $(Q) mkdir -p $@
+$(FW_BASE):
     $(Q) mkdir -p $@
 
+#flash: $(FW_FILE_1) $(FW_FILE_2)
+#    $(Q) $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x00000 -cf firmware/0x00000.bin -v
+#    $(Q) [ $(ESPDELAY) -ne 0 ] &amp;&amp; echo &quot;Please put the ESP in bootloader mode...&quot; || true
+#    $(Q) sleep $(ESPDELAY) || true
+#    $(Q) $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x40000 -cf firmware/0x40000.bin -v
 flash: $(FW_FILE_1) $(FW_FILE_2)
-    $(Q) $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x00000 -cf firmware/0x00000.bin -v
-    $(Q) [ $(ESPDELAY) -ne 0 ] &amp;&amp; echo &quot;Please put the ESP in bootloader mode...&quot; || true
-    $(Q) sleep $(ESPDELAY) || true
-    $(Q) $(ESPTOOL) -cp $(ESPPORT) -cb $(ESPBAUD) -ca 0x40000 -cf firmware/0x40000.bin -v
+    $(ESPTOOL) --port $(ESPPORT) write_flash $(FW_FILE_1_ADDR) $(FW_FILE_1) $(FW_FILE_2_ADDR) $(FW_FILE_2)
+
+
 
 clean:
     $(Q) rm -f $(APP_AR)</pre>
<p>・再度make </p>
<blockquote>
<p>$ make clean<br>
    <br>$ make</p>
<p>CC user/cgiwifi.c</p>
<p>CC user/config.c</p>
<p>CC user/eink.c</p>
<p>CC user/espfs.c</p>
<p>CC user/heatshrink_decoder.c</p>
<p>CC user/httpd.c</p>
<p>CC user/httpdclient.c</p>
<p>CC user/httpdespfs.c</p>
<p>CC user/io.c</p>
<p>CC user/stdout.c</p>
<p>CC user/user_main.c</p>
<p>AR build/einkdisp_app.a</p>
<p>LD build/einkdisp.out</p>
<p>FW firmware/</p>
</blockquote>
<p>エラーはなくなりました。</p>
<p>・とりあえず、こんな感じになっています。 </p>
<p>$ tree<br>
  <br>.</p>
<p>├── Makefile</p>
<p>├── Makefile.patch</p>
<p>├── Makefile_org</p>
<p>├── README</p>
<p>├── build</p>
<p>│&#160;&#160; ├── driver</p>
<p>│&#160;&#160; ├── einkdisp.out★これはどの領域に書き込めばいいのでしょうかね？</p>
<p>│&#160;&#160; ├── einkdisp_app.a</p>
<p>│&#160;&#160; └── user</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── cgiwifi.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── config.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── eink.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── espfs.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_decoder.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── httpd.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── httpdclient.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── httpdespfs.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── io.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── stdout.o</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; └── user_main.o</p>
<p>├── firmware</p>
<p>│&#160;&#160; ├── 0x00000.bin★</p>
<p>│&#160;&#160; └── 0x40000.bin★</p>
<p>├── html</p>
<p>│&#160;&#160; ├── 140medley.min.js</p>
<p>│&#160;&#160; ├── apconnect.bm</p>
<p>│&#160;&#160; ├── batempty.bm</p>
<p>│&#160;&#160; ├── connecting.html</p>
<p>│&#160;&#160; ├── icons.png</p>
<p>│&#160;&#160; ├── neterror.bm</p>
<p>│&#160;&#160; ├── style.css</p>
<p>│&#160;&#160; └── wifi.tpl</p>
<p>├── icons</p>
<p>│&#160;&#160; ├── apconnect.png</p>
<p>│&#160;&#160; ├── batempty.png</p>
<p>│&#160;&#160; └── neterror.png</p>
<p>├── include</p>
<p>│&#160;&#160; ├── espmissingincludes-ip.h</p>
<p>│&#160;&#160; ├── espmissingincludes.h</p>
<p>│&#160;&#160; ├── ip_addr.h</p>
<p>│&#160;&#160; ├── lwipopts.h</p>
<p>│&#160;&#160; ├── spi_register.h</p>
<p>│&#160;&#160; ├── stdint.h</p>
<p>│&#160;&#160; ├── uart_hw.h</p>
<p>│&#160;&#160; └── user_config.h</p>
<p>├── lib</p>
<p>│&#160;&#160; └── heatshrink</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── LICENSE</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── Makefile</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── README.md</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── dec_sm.dot</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── enc_sm.dot</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── greatest.h</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink.c</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_common.h</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_config.h</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_decoder.c</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_decoder.h</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_encoder.c</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── heatshrink_encoder.h</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── test_heatshrink_dynamic.c</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; ├── test_heatshrink_dynamic_theft.c</p>
<p>│&#160;&#160;&#160;&#160;&#160;&#160; └── test_heatshrink_static.c</p>
<p>├── mkespfsimage</p>
<p>│&#160;&#160; ├── Makefile</p>
<p>│&#160;&#160; ├── espfsformat.h</p>
<p>│&#160;&#160; ├── heatshrink_encoder.c</p>
<p>│&#160;&#160; ├── heatshrink_encoder.o</p>
<p>│&#160;&#160; ├── main.c</p>
<p>│&#160;&#160; ├── main.o</p>
<p>│&#160;&#160; └── mkespfsimage</p>
<p>├── mkimg.php</p>
<p>├── server</p>
<p>│&#160;&#160; ├── README</p>
<p>│&#160;&#160; └── pixelserver.js</p>
<p>└── user</p>
<p>&#160;&#160;&#160; ├── cgiwifi.c</p>
<p>&#160;&#160;&#160; ├── cgiwifi.h</p>
<p>&#160;&#160;&#160; ├── config.c</p>
<p>&#160;&#160;&#160; ├── config.h</p>
<p>&#160;&#160;&#160; ├── eink.c</p>
<p>&#160;&#160;&#160; ├── eink.h</p>
<p>&#160;&#160;&#160; ├── espfs.c</p>
<p>&#160;&#160;&#160; ├── espfs.h</p>
<p>&#160;&#160;&#160; ├── heatshrink_config_httpd.h</p>
<p>&#160;&#160;&#160; ├── heatshrink_decoder.c</p>
<p>&#160;&#160;&#160; ├── httpd.c</p>
<p>&#160;&#160;&#160; ├── httpd.h</p>
<p>&#160;&#160;&#160; ├── httpdclient.c</p>
<p>&#160;&#160;&#160; ├── httpdclient.h</p>
<p>&#160;&#160;&#160; ├── httpdconfig.h</p>
<p>&#160;&#160;&#160; ├── httpdespfs.c</p>
<p>&#160;&#160;&#160; ├── httpdespfs.h</p>
<p>&#160;&#160;&#160; ├── io.c</p>
<p>&#160;&#160;&#160; ├── io.h</p>
<p>&#160;&#160;&#160; ├── stdout.c</p>
<p>&#160;&#160;&#160; ├── stdout.h</p>
<p>&#160;&#160;&#160; └── user_main.c </p>
<p>12 directories, 86 files</p>
<p>&#160;</p>
<p>▼まとめ</p>
<p>・SDK にいくつを使っていたか不明。作者に聞くことに</p>
<p>・PhantomJS で動作する pixelserver.js は別サーバにおくのかどうか？</p>
<p>・ビルドするには、esp-open-sdk を使えばいいのか、それとも他の方法か不明。</p>
<p>・ビルドしてできたものは、どのようにどの領域に書き込めばいいのか不明。</p>
<p>&#160;</p>
<p>▼参考<br>
  <br><a href="http://nemuisan.blog.bai.ne.jp/?eid=215341" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://nemuisan.blog.bai.ne.jp/?eid=215341<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p><a href="http://dsas.blog.klab.org/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://dsas.blog.klab.org/<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p><a href="http://www.homu.net/esp8266%E7%94%A8open-sdk%E3%82%92macosx%E7%94%A8%E3%81%AB%E3%83%93%E3%83%AB%E3%83%89%E3%81%99%E3%82%8B/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.homu.net/esp8266%E7%94%A8open-sdk%E3%82%92macosx%E7%94%A8%E3%81%AB%E3%83%93%E3%83%AB%E3%83%89%E3%81%99%E3%82%8B/<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p><a href="http://bbs.espressif.com/viewforum.php?f=46" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://bbs.espressif.com/viewforum.php?f=46<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p><a href="https://github.com/esp8266/esp8266-wiki/tree/master/sdk" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://github.com/esp8266/esp8266-wiki/tree/master/sdk<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p><a href="http://nemuisan.blog.bai.ne.jp/?eid=215341" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://nemuisan.blog.bai.ne.jp/?eid=215341<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
					</div>
<!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div>
<!-- .entry-wrapper -->
</article><!-- #post-## -->

			
			
		
		</main><!-- #main -->
	</section><!-- #primary -->


	</div>
<!-- #content -->

	<footer id="colophon" class="site-footer wrap" role="contentinfo">
		<div class="site-info">
			Copyleft - all rights reversed.
			<span class="sep"> | </span>
			JunkHack 2011 - 2024
			<span class="sep"> | </span>
			<a href="/about-junkhack/" data-wpel-link="internal" rel="noopener noreferrer">運営者情報<span class="gf"></span></a><span class="sep"> | </span>
			<a href="/mail/" data-wpel-link="internal" rel="noopener noreferrer">お問い合わせ<span class="gf"></span></a><span class="sep"> | </span>
			<a href="/privacy/" data-wpel-link="internal" rel="noopener noreferrer">プライバシーポリシー<span class="gf"></span></a>
		</div>
<!-- .site-info -->

	</footer><!-- #colophon -->
</div>
<!-- #page -->

    <div id="mouse">
        <div class="inner">
            <h1>Search</h1>
            
                    <form class="uagb-search-wrapper" role="search" action="https://hack.gpl.jp/" method="get">
                        <div class="uagb-search-form__container" role="tablist">

                            <input placeholder="Search" class="uagb-search-form__input aa-input" id="searchbox" type="search" name="s" title="Search" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="width: 80%;">
                            <pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: normal; text-indent: 0px; text-rendering: auto; text-transform: none;">
                            </pre>
                        </div>
                    </form>

            <table>
                <tr>
                    <td class="divide">
                        <table>
                                <tr>
        <td>
<span class="cmd">g</span> <span class="thn">then</span> <span class="cmd">h</span>
</td>
        <td><span class="help">&rarr; home</span></td>
        <td>Go to front page</td>
    </tr>    
                                    <tr>
        <td>
<span class="cmd">g</span> <span class="thn">then</span> <span class="cmd">l</span>
</td>
        <td><span class="help">&rarr; list</span></td>
        <td>Go to List page</td>
    </tr>    
                                    <tr>
        <td>
<span class="cmd">g</span> <span class="thn">then</span> <span class="cmd">s</span>
</td>
        <td><span class="help">&rarr; search</span></td>
        <td>Go to Search page</td>
    </tr>    
                            </table>                    
                    </td>
                    <td class="divide">
                        <table>
                                <tr>
        <td><span class="cmd">/ or esc</span></td>
        <td><span class="help">&rarr; search</span></td>
        <td>Toggle , Close the search box</td>
    </tr>    
                                    <tr>
        <td><span class="cmd">.</span></td>
        <td><span class="help">&rarr; Focus</span></td>
        <td>Focus the search box</td>
    </tr>    
                                    <tr>
        <td><span class="cmd">Mouse Click</span></td>
        <td><span class="help">&rarr; unFocus</span></td>
        <td>unFocus the search box</td>
    </tr>    
                            </table>
                    
                    </td>
                </tr>
            </table>  
        </div>
    </div>
    <script type="text/javascript">var algolia = {"debug":false,"application_id":"8DCPU3VRUU","search_api_key":"052e9cca1df4182ec607663dc893c235","powered_by_enabled":true,"query":"","autocomplete":{"sources":[{"index_id":"posts_post","index_name":"wp_posts_post","label":"投稿","admin_name":"投稿","position":10,"max_suggestions":10,"tmpl_suggestion":"autocomplete-post-suggestion","enabled":true}],"input_selector":"input[name='s']:not(.no-autocomplete):not(#adminbar-search)"},"indices":{"searchable_posts":{"name":"wp_searchable_posts","id":"searchable_posts","enabled":true,"replicas":[]},"posts_post":{"name":"wp_posts_post","id":"posts_post","enabled":true,"replicas":[]}}};</script>
<script type="text/html" id="tmpl-autocomplete-header"><div class="autocomplete-header">
		<div class="autocomplete-header-title">{{{ data.label }}}</div>
		<div class="clear"></div>
	</div></script>

<script type="text/html" id="tmpl-autocomplete-post-suggestion">
	<a class="suggestion-link" href="{{ data.permalink }}" title="{{ data.post_title }}">
		<# if ( data.images.thumbnail ) { #>
			<img class="suggestion-post-thumbnail" src="{{ data.images.thumbnail.url }}" alt="{{ data.post_title }}">
		<# } #>
		<div class="suggestion-post-attributes">
			<span class="suggestion-post-title">{{{ data._highlightResult.post_title.value }}}</span>
			<# if ( data._snippetResult['content'] ) { #>
				<span class="suggestion-post-content">{{{ data._snippetResult['content'].value }}}</span>
			<# } #>
		</div>
			</a>
</script>

<script type="text/html" id="tmpl-autocomplete-term-suggestion">
	<a class="suggestion-link" href="{{ data.permalink }}" title="{{ data.name }}">
		<svg viewBox="0 0 21 21" width="21" height="21">
			<svg width="21" height="21" viewBox="0 0 21 21">
				<path
					d="M4.662 8.72l-1.23 1.23c-.682.682-.68 1.792.004 2.477l5.135 5.135c.7.693 1.8.688 2.48.005l1.23-1.23 5.35-5.346c.31-.31.54-.92.51-1.36l-.32-4.29c-.09-1.09-1.05-2.06-2.15-2.14l-4.3-.33c-.43-.03-1.05.2-1.36.51l-.79.8-2.27 2.28-2.28 2.27zm9.826-.98c.69 0 1.25-.56 1.25-1.25s-.56-1.25-1.25-1.25-1.25.56-1.25 1.25.56 1.25 1.25 1.25z"
					fill-rule="evenodd"></path>
			</svg>
		</svg>
		<span class="suggestion-post-title">{{{ data._highlightResult.name.value }}}</span>
	</a>
</script>

<script type="text/html" id="tmpl-autocomplete-user-suggestion">
	<a class="suggestion-link user-suggestion-link" href="{{ data.posts_url }}" title="{{ data.display_name }}">
		<# if ( data.avatar_url ) { #>
			<img class="suggestion-user-thumbnail" src="{{ data.avatar_url }}" alt="{{ data.display_name }}">
		<# } #>
		<span class="suggestion-post-title">{{{ data._highlightResult.display_name.value }}}</span>
	</a>
</script>

<script type="text/html" id="tmpl-autocomplete-footer">
	<div class="autocomplete-footer">
		<div class="autocomplete-footer-branding">
			<a href="#" class="algolia-powered-by-link" title="Algolia">
				<svg width="150px" height="25px" viewbox="0 0 572 64"><path fill="#36395A" d="M16 48.3c-3.4 0-6.3-.6-8.7-1.7A12.4 12.4 0 0 1 1.9 42C.6 40 0 38 0 35.4h6.5a6.7 6.7 0 0 0 3.9 6c1.4.7 3.3 1.1 5.6 1.1 2.2 0 4-.3 5.4-1a7 7 0 0 0 3-2.4 6 6 0 0 0 1-3.4c0-1.5-.6-2.8-1.9-3.7-1.3-1-3.3-1.6-5.9-1.8l-4-.4c-3.7-.3-6.6-1.4-8.8-3.4a10 10 0 0 1-3.3-7.9c0-2.4.6-4.6 1.8-6.4a12 12 0 0 1 5-4.3c2.2-1 4.7-1.6 7.5-1.6s5.5.5 7.6 1.6a12 12 0 0 1 5 4.4c1.2 1.8 1.8 4 1.8 6.7h-6.5a6.4 6.4 0 0 0-3.5-5.9c-1-.6-2.6-1-4.4-1s-3.2.3-4.4 1c-1.1.6-2 1.4-2.6 2.4-.5 1-.8 2-.8 3.1a5 5 0 0 0 1.5 3.6c1 1 2.6 1.7 4.7 1.9l4 .3c2.8.2 5.2.8 7.2 1.8 2.1 1 3.7 2.2 4.9 3.8a9.7 9.7 0 0 1 1.7 5.8c0 2.5-.7 4.7-2 6.6a13 13 0 0 1-5.6 4.4c-2.4 1-5.2 1.6-8.4 1.6Zm35.6 0c-2.6 0-4.8-.4-6.7-1.3a13 13 0 0 1-4.7-3.5 17.1 17.1 0 0 1-3.6-10.4v-1c0-2 .3-3.8 1-5.6a13 13 0 0 1 7.3-8.3 15 15 0 0 1 6.3-1.4A13.2 13.2 0 0 1 64 24.3c1 2.2 1.6 4.6 1.6 7.2V34H39.4v-4.3h21.8l-1.8 2.2c0-2-.3-3.7-.9-5.1a7.3 7.3 0 0 0-2.7-3.4c-1.2-.7-2.7-1.1-4.6-1.1s-3.4.4-4.7 1.3a8 8 0 0 0-2.9 3.6c-.6 1.5-.9 3.3-.9 5.4 0 2 .3 3.7 1 5.3a7.9 7.9 0 0 0 2.8 3.7c1.3.8 3 1.3 5 1.3s3.8-.5 5.1-1.3c1.3-1 2.1-2 2.4-3.2h6a11.8 11.8 0 0 1-7 8.7 16 16 0 0 1-6.4 1.2ZM80 48c-2.2 0-4-.3-5.7-1a8.4 8.4 0 0 1-3.7-3.3 9.7 9.7 0 0 1-1.3-5.2c0-2 .5-3.8 1.5-5.2a9 9 0 0 1 4.3-3.1c1.8-.7 4-1 6.7-1H89v4.1h-7.5c-2 0-3.4.5-4.4 1.4-1 1-1.6 2.1-1.6 3.6s.5 2.7 1.6 3.6c1 1 2.5 1.4 4.4 1.4 1.1 0 2.2-.2 3.2-.7 1-.4 1.9-1 2.6-2 .6-1 1-2.4 1-4.2l1.7 2.1c-.2 2-.7 3.8-1.5 5.2a9 9 0 0 1-3.4 3.3 12 12 0 0 1-5.3 1Zm9.5-.7v-8.8h-1v-10c0-1.8-.5-3.2-1.4-4.1-1-1-2.4-1.4-4.2-1.4a142.9 142.9 0 0 0-10.2.4v-5.6a74.8 74.8 0 0 1 8.6-.4c3 0 5.5.4 7.5 1.2s3.4 2 4.4 3.6c1 1.7 1.4 4 1.4 6.7v18.4h-5Zm12.9 0V17.8h5v12.3h-.2c0-4.2 1-7.4 2.8-9.5a11 11 0 0 1 8.3-3.1h1v5.6h-2a9 9 0 0 0-6.3 2.2c-1.5 1.5-2.2 3.6-2.2 6.4v15.6h-6.4Zm34.4 1a15 15 0 0 1-6.6-1.3c-1.9-.9-3.4-2-4.7-3.5a15.5 15.5 0 0 1-2.7-5c-.6-1.7-1-3.6-1-5.4v-1c0-2 .4-3.8 1-5.6a15 15 0 0 1 2.8-4.9c1.3-1.5 2.8-2.6 4.6-3.5a16.4 16.4 0 0 1 13.3.2c2 1 3.5 2.3 4.8 4a12 12 0 0 1 2 6H144c-.2-1.6-1-3-2.2-4.1a7.5 7.5 0 0 0-5.2-1.7 8 8 0 0 0-4.7 1.3 8 8 0 0 0-2.8 3.6 13.8 13.8 0 0 0 0 10.3c.6 1.5 1.5 2.7 2.8 3.6s2.8 1.3 4.8 1.3c1.5 0 2.7-.2 3.8-.8a7 7 0 0 0 2.6-2c.7-1 1-2 1.2-3.2h6.2a11 11 0 0 1-2 6.2 15.1 15.1 0 0 1-11.8 5.5Zm19.7-1v-40h6.4V31h-1.3c0-3 .4-5.5 1.1-7.6a9.7 9.7 0 0 1 3.5-4.8A9.9 9.9 0 0 1 172 17h.3c3.5 0 6 1.1 7.9 3.5 1.7 2.3 2.6 5.7 2.6 10v16.8h-6.4V29.6c0-2.1-.6-3.8-1.8-5a6.4 6.4 0 0 0-4.8-1.8c-2 0-3.7.7-5 2a7.8 7.8 0 0 0-1.9 5.5v17h-6.4Zm63.8 1a12.2 12.2 0 0 1-10.9-6.2 19 19 0 0 1-1.8-7.3h1.4v12.5h-5.1v-40h6.4v19.8l-2 3.5c.2-3.1.8-5.7 1.9-7.7a11 11 0 0 1 4.4-4.5c1.8-1 3.9-1.5 6.1-1.5a13.4 13.4 0 0 1 12.8 9.1c.7 1.9 1 3.8 1 6v1c0 2.2-.3 4.1-1 6a13.6 13.6 0 0 1-13.2 9.4Zm-1.2-5.5a8.4 8.4 0 0 0 7.9-5c.7-1.5 1.1-3.3 1.1-5.3s-.4-3.8-1.1-5.3a8.7 8.7 0 0 0-3.2-3.6 9.6 9.6 0 0 0-9.2-.2 8.5 8.5 0 0 0-3.3 3.2c-.8 1.4-1.3 3-1.3 5v2.3a9 9 0 0 0 1.3 4.8 9 9 0 0 0 3.4 3c1.4.7 2.8 1 4.4 1Zm27.3 3.9-10-28.9h6.5l9.5 28.9h-6Zm-7.5 12.2v-5.7h4.9c1 0 2-.1 2.9-.4a4 4 0 0 0 2-1.4c.4-.7.9-1.6 1.2-2.7l8.6-30.9h6.2l-9.3 32.4a14 14 0 0 1-2.5 5 8.9 8.9 0 0 1-4 2.8c-1.5.6-3.4.9-5.6.9h-4.4Zm9-12.2v-5.2h6.4v5.2H248Z"></path><path fill="#003DFF" d="M534.4 9.1H528a.8.8 0 0 1-.7-.7V1.8c0-.4.2-.7.6-.8l6.5-1c.4 0 .8.2.9.6v7.8c0 .4-.4.7-.8.7zM428 35.2V.8c0-.5-.3-.8-.7-.8h-.2l-6.4 1c-.4 0-.7.4-.7.8v35c0 1.6 0 11.8 12.3 12.2.5 0 .8-.4.8-.8V43c0-.4-.3-.7-.6-.8-4.5-.5-4.5-6-4.5-7zm106.5-21.8H528c-.4 0-.7.4-.7.8v34c0 .4.3.8.7.8h6.5c.4 0 .8-.4.8-.8v-34c0-.5-.4-.8-.8-.8zm-17.7 21.8V.8c0-.5-.3-.8-.8-.8l-6.5 1c-.4 0-.7.4-.7.8v35c0 1.6 0 11.8 12.3 12.2.4 0 .8-.4.8-.8V43c0-.4-.3-.7-.7-.8-4.4-.5-4.4-6-4.4-7zm-22.2-20.6a16.5 16.5 0 0 1 8.6 9.3c.8 2.2 1.3 4.8 1.3 7.5a19.4 19.4 0 0 1-4.6 12.6 14.8 14.8 0 0 1-5.2 3.6c-2 .9-5.2 1.4-6.8 1.4a21 21 0 0 1-6.7-1.4 15.4 15.4 0 0 1-8.6-9.3 21.3 21.3 0 0 1 0-14.4 15.2 15.2 0 0 1 8.6-9.3c2-.8 4.3-1.2 6.7-1.2s4.6.4 6.7 1.2zm-6.7 27.6c2.7 0 4.7-1 6.2-3s2.2-4.3 2.2-7.8-.7-6.3-2.2-8.3-3.5-3-6.2-3-4.7 1-6.1 3c-1.5 2-2.2 4.8-2.2 8.3s.7 5.8 2.2 7.8 3.5 3 6.2 3zm-88.8-28.8c-6.2 0-11.7 3.3-14.8 8.2a18.6 18.6 0 0 0 4.8 25.2c1.8 1.2 4 1.8 6.2 1.7s.1 0 .1 0h.9c4.2-.7 8-4 9.1-8.1v7.4c0 .4.3.7.8.7h6.4a.7.7 0 0 0 .7-.7V14.2c0-.5-.3-.8-.7-.8h-13.5zm6.3 26.5a9.8 9.8 0 0 1-5.7 2h-.5a10 10 0 0 1-9.2-14c1.4-3.7 5-6.3 9-6.3h6.4v18.3zm152.3-26.5h13.5c.5 0 .8.3.8.7v33.7c0 .4-.3.7-.8.7h-6.4a.7.7 0 0 1-.8-.7v-7.4c-1.2 4-4.8 7.4-9 8h-.1a4.2 4.2 0 0 1-.5.1h-.9a10.3 10.3 0 0 1-7-2.6c-4-3.3-6.5-8.4-6.5-14.2 0-3.7 1-7.2 3-10 3-5 8.5-8.3 14.7-8.3zm.6 28.4c2.2-.1 4.2-.6 5.7-2V21.7h-6.3a9.8 9.8 0 0 0-9 6.4 10.2 10.2 0 0 0 9.1 13.9h.5zM452.8 13.4c-6.2 0-11.7 3.3-14.8 8.2a18.5 18.5 0 0 0 3.6 24.3 10.4 10.4 0 0 0 13 .6c2.2-1.5 3.8-3.7 4.5-6.1v7.8c0 2.8-.8 5-2.2 6.3-1.5 1.5-4 2.2-7.5 2.2l-6-.3c-.3 0-.7.2-.8.5l-1.6 5.5c-.1.4.1.8.5 1h.1c2.8.4 5.5.6 7 .6 6.3 0 11-1.4 14-4.1 2.7-2.5 4.2-6.3 4.5-11.4V14.2c0-.5-.4-.8-.8-.8h-13.5zm6.3 8.2v18.3a9.6 9.6 0 0 1-5.6 2h-1a10.3 10.3 0 0 1-8.8-14c1.4-3.7 5-6.3 9-6.3h6.4zM291 31.5A32 32 0 0 1 322.8 0h30.8c.6 0 1.2.5 1.2 1.2v61.5c0 1.1-1.3 1.7-2.2 1l-19.2-17a18 18 0 0 1-11 3.4 18.1 18.1 0 1 1 18.2-14.8c-.1.4-.5.7-.9.6-.1 0-.3 0-.4-.2l-3.8-3.4c-.4-.3-.6-.8-.7-1.4a12 12 0 1 0-2.4 8.3c.4-.4 1-.5 1.6-.2l14.7 13.1v-46H323a26 26 0 1 0 10 49.7c.8-.4 1.6-.2 2.3.3l3 2.7c.3.2.3.7 0 1l-.2.2a32 32 0 0 1-47.2-28.6z"></path></svg>
			</a>
		</div>
	</div>
</script>

<script type="text/html" id="tmpl-autocomplete-empty"><div class="autocomplete-empty">
		クエリにマッチした結果はありません		<span class="empty-query">"{{ data.query }}"</span>
	</div></script>

<script type="text/javascript">
	window.addEventListener('load', function () {

		/* Initialize Algolia client */
		var client = algoliasearch( algolia.application_id, algolia.search_api_key );

		/**
		 * Algolia hits source method.
		 *
		 * This method defines a custom source to use with autocomplete.js.
		 *
		 * @param object $index Algolia index object.
		 * @param object $params Options object to use in search.
		 */
		var algoliaHitsSource = function( index, params ) {
			return function( query, callback ) {
				index
					.search( query, params )
					.then( function( response ) {
						callback( response.hits, response );
					})
					.catch( function( error ) {
						callback( [] );
					});
			}
		}

		/* Setup autocomplete.js sources */
		var sources = [];
		algolia.autocomplete.sources.forEach( function( config, i ) {
			var suggestion_template = wp.template( config[ 'tmpl_suggestion' ] );
			sources.push( {
				source: algoliaHitsSource( client.initIndex( config[ 'index_name' ] ), {
					hitsPerPage: config[ 'max_suggestions' ],
					attributesToSnippet: [
						'content:10'
					],
					highlightPreTag: '__ais-highlight__',
					highlightPostTag: '__/ais-highlight__'
				} ),
				templates: {
					header: function () {
						return wp.template( 'autocomplete-header' )( {
							label: _.escape( config[ 'label' ] )
						} );
					},
					suggestion: function ( hit ) {
						if ( hit.escaped === true ) {
							return suggestion_template( hit );
						}
						hit.escaped = true;

						for ( var key in hit._highlightResult ) {
							/* We do not deal with arrays. */
							if ( typeof hit._highlightResult[ key ].value !== 'string' ) {
								continue;
							}
							hit._highlightResult[ key ].value = _.escape( hit._highlightResult[ key ].value );
							hit._highlightResult[ key ].value = hit._highlightResult[ key ].value.replace( /__ais-highlight__/g, '<em>' ).replace( /__\/ais-highlight__/g, '<\/em>' );
						}

						for ( var key in hit._snippetResult ) {
							/* We do not deal with arrays. */
							if ( typeof hit._snippetResult[ key ].value !== 'string' ) {
								continue;
							}

							hit._snippetResult[ key ].value = _.escape( hit._snippetResult[ key ].value );
							hit._snippetResult[ key ].value = hit._snippetResult[ key ].value.replace( /__ais-highlight__/g, '<em>' ).replace( /__\/ais-highlight__/g, '<\/em>' );
						}

						return suggestion_template( hit );
					}
				}
			} );

		} );

		/* Setup dropdown menus */
		document.querySelectorAll( algolia.autocomplete.input_selector ).forEach( function( element ) {

			var config = {
				debug: algolia.debug,
				hint: false,
				openOnFocus: true,
				appendTo: 'body',
				templates: {
					empty: wp.template( 'autocomplete-empty' )
				}
			};

			if ( algolia.powered_by_enabled ) {
				config.templates.footer = wp.template( 'autocomplete-footer' );
			}

			/* Instantiate autocomplete.js */
			var autocomplete = algoliaAutocomplete( element, config, sources )
				.on( 'autocomplete:selected', function ( e, suggestion ) {
					/* Redirect the user when we detect a suggestion selection. */
					window.location.href = suggestion.permalink ?? suggestion.posts_url; // Users use the `posts_url` property instead of `permalink`.
				} );

			/* Force the dropdown to be re-drawn on scroll to handle fixed containers. */
			window.addEventListener( 'scroll', function() {
				if ( autocomplete.autocomplete.getWrapper().style.display === "block" ) {
					autocomplete.autocomplete.close();
					autocomplete.autocomplete.open();
				}
			} );
		} );

		var algoliaPoweredLink = document.querySelector( '.algolia-powered-by-link' );
		if ( algoliaPoweredLink ) {
			algoliaPoweredLink.addEventListener( 'click', function( e ) {
				e.preventDefault();
				window.location = "https://www.algolia.com/?utm_source=WordPress&utm_medium=extension&utm_content=" + window.location.hostname + "&utm_campaign=poweredby";
			} );
		}
	});
</script>
<script type="text/javascript" src="/wp-content/themes/jh-hew/js/JankHack-Hew.js?ver=20140909" id="JankHack-Hew-scripts-js"></script>
<script type="text/javascript" src="/wp-content/themes/jh-hew/js/navigation.js?ver=20120206" id="JankHack-Hew-navigation-js"></script>
<script type="text/javascript" src="/wp-content/themes/jh-hew/js/skip-link-focus-fix.js?ver=20130115" id="JankHack-Hew-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="/wp-content/themes/jh-hew/js/contact.js?ver=20210612" id="sendmail-js"></script>
<script type="text/javascript" src="/wp-includes/js/underscore.min.js?ver=1.13.4" id="underscore-js"></script>
<script type="text/javascript" id="wp-util-js-extra">
/* <![CDATA[ */
var _wpUtilSettings = {"ajax":{"url":"\/wp-admin\/admin-ajax.php"}};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-includes/js/wp-util.min.js?ver=6.4.3" id="wp-util-js"></script>
<script type="text/javascript" src="/wp-content/plugins/wp-search-with-algolia/js/algoliasearch/dist/algoliasearch-lite.umd.js?ver=2.7.1" id="algolia-search-js"></script>
<script type="text/javascript" src="/wp-content/plugins/wp-search-with-algolia/js/autocomplete.js/dist/autocomplete.min.js?ver=2.7.1" id="algolia-autocomplete-js"></script>
<script type="text/javascript" src="/wp-content/plugins/wp-search-with-algolia/js/autocomplete-noconflict.js?ver=2.7.1" id="algolia-autocomplete-noconflict-js"></script>
<script type="text/javascript" src="/wp-includes/js/clipboard.min.js?ver=2.0.11" id="clipboard-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs//emojify.js/1.1.0/js/emojify.min.js?ver=1.1.0" id="emojify-js"></script>
<script type="text/javascript" id="wpfront-scroll-top-js-extra">
/* <![CDATA[ */
var wpfront_scroll_top_data = {"data":{"css":"#wpfront-scroll-top-container{display:none;position:fixed;cursor:pointer;z-index:9999;opacity:0}#wpfront-scroll-top-container div.text-holder{padding:3px 10px;border-radius:3px;-webkit-border-radius:3px;-webkit-box-shadow:4px 4px 5px 0 rgba(50,50,50,.5);-moz-box-shadow:4px 4px 5px 0 rgba(50,50,50,.5);box-shadow:4px 4px 5px 0 rgba(50,50,50,.5)}#wpfront-scroll-top-container a{outline-style:none;box-shadow:none;text-decoration:none}#wpfront-scroll-top-container {right: 80px;bottom: 10px;}        #wpfront-scroll-top-container img {\n            width: 55px;\n            height: 55px;\n        }\n        ","html":"<div id=\"wpfront-scroll-top-container\"><img src=\"\/wp-content\/plugins\/wpfront-scroll-top\/images\/icons\/1.png\" alt=\"\" title=\"\" \/><\/div>","data":{"hide_iframe":false,"button_fade_duration":200,"auto_hide":false,"auto_hide_after":2,"scroll_offset":100,"button_opacity":0.8,"button_action":"top","button_action_element_selector":"","button_action_container_selector":"html, body","button_action_element_offset":"0","scroll_duration":400}}};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/wpfront-scroll-top/js/wpfront-scroll-top.min.js?ver=2.2.10081" id="wpfront-scroll-top-js"></script>
  <script id="module-flowchart">(function($) { $(function() { if (typeof $.fn.flowChart !== "undefined") { if ($(".language-flow").length > 0) { $(".language-flow").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-flow").addClass("flowchart").removeClass("language-flow"); $(".flowchart").flowChart(); } } }); })(jQuery);</script>  <script id="module-katex"> (function($) { $(function() { if (typeof katex !== "undefined") { if ($(".language-katex").length > 0) { $(".language-katex").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-katex").addClass("katex-container").removeClass("language-katex"); $(".katex-container").each(function() { var katexText = $(this).text(); var el = $(this).get(0); if ($(this).parent("code").length == 0) { try { katex.render(katexText, el) } catch (err) { $(this).html("<span class='err'>" + err) } } }); } if ($(".katex-inline").length > 0) { $(".katex-inline").each(function() { var katexText = $(this).text(); var el = $(this).get(0); if ($(this).parent("code").length == 0) { try { katex.render(katexText, el) } catch (err) { $(this).html("<span class='err'>" + err) } } }); } } }); })(jQuery); </script>  <script id="module-sequence-diagram">(function($) { $(function() { if (typeof $.fn.sequenceDiagram !== "undefined") { $(".language-sequence").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-seq").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-sequence").addClass("sequence-diagram").removeClass("language-sequence"); $(".language-seq").addClass("sequence-diagram").removeClass("language-seq"); $(".sequence-diagram").sequenceDiagram({ theme: "simple" }); } }); })(jQuery);</script>  <script id="module-mermaid">(function($) { $(function() { if (typeof mermaid !== "undefined") { if ($(".language-mermaid").length > 0) { $(".language-mermaid").parent("pre").attr("style", "text-align: center; background: none;"); $(".language-mermaid").addClass("mermaid").removeClass("language-mermaid"); mermaid.init(); } } }); })(jQuery);</script>  <script id="module-mathjax">(function($) { $(function() { if (typeof MathJax !== "undefined") { var c = $(".language-mathjax").length; if (c > 0) { $(".language-mathjax").each(function(i) { var content = $(this).html(); if ($(this).hasClass("mathjax-inline")) { $(this).html("$ " + content + " $"); } else { $(this).html("$$" + "\n" + content + "\n" + "$$"); } if (i + 1 === c) { MathJax.Hub.Config({ showProcessingMessages: false, messageStyle: "none", extensions: [ "tex2jax.js", "TeX/mediawiki-texvc.js", "TeX/noUndefined.js", "TeX/autoload-all.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js" ], jax: [ "input/TeX", "output/SVG" ], elements: document.getElementsByClassName("language-mathjax"), tex2jax: { skipTags: [ "script", "noscript", "style", "textarea" ], inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processClass: "language-mathjax" } }); MathJax.Hub.Queue(["Typeset", MathJax.Hub]); $(".language-mathjax").attr("style", "background: transparent; border: 0;"); $(".language-mathjax").closest("pre").attr("style", "background: transparent; border: 0;"); } }); } else { console.log("[wp-githuber-md] MathJax code blocks not found."); } } else { console.log("[wp-githuber-md] MathJax is not loadded."); } }); })(jQuery);</script>  <script id="module-clipboard"> (function($) { $(function() { var pre = document.getElementsByTagName("pre"); var pasteContent = document.getElementById("paste-content"); var hasLanguage = false; for (var i = 0; i < pre.length; i++) { var codeClass = pre[i].children[0].className; var isLanguage = codeClass.indexOf("language-"); var excludedCodeClassNames = [ "language-katex", "language-seq", "language-sequence", "language-flow", "language-flowchart", "language-mermaid", ]; var isExcluded = excludedCodeClassNames.indexOf(codeClass); if (isExcluded !== -1) { isLanguage = -1; } if (isLanguage !== -1) { var current_pre = pre[i]; var parent = current_pre.parentNode; var div = document.createElement("div"); div.style['position'] = 'relative'; parent.replaceChild(div, current_pre); var button = document.createElement("button"); button.className = "copy-button"; button.textContent = "Copy"; div.appendChild(current_pre); div.appendChild(button); hasLanguage = true; } }; if (hasLanguage) { var copyCode = new ClipboardJS(".copy-button", { target: function(trigger) { return trigger.previousElementSibling; } }); copyCode.on("success", function(event) { event.clearSelection(); event.trigger.textContent = "Copied"; window.setTimeout(function() { event.trigger.textContent = "Copy"; }, 2000); }); } }); })(jQuery); </script> 
			<script id="module-emojify">(function($) {
					$(function() {
						if (typeof emojify !== "undefined") {
							emojify.setConfig({
								img_dir: "https://cdnjs.cloudflare.com/ajax/libs//emojify.js/1.1.0/images/basic",
								blacklist: {
									"classes": ["no-emojify"],
									"elements": ["script", "textarea", "pre", "code"]
								}
							});
							emojify.run();
						} else {
							console.log("[wp-githuber-md] emogify is undefined.");
						}
					});
				})(jQuery);</script>
		
</body>
</html>